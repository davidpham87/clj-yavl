{"version":3,"sources":["clj_yavl/viz.cljs"],"mappings":";;AAIA,6BAAA,7BAAMA,kEAAeC;AAArB,AACE,IAAMC,gBAAc,gDAAA,hDAACC;IACfC,WAAS,gDAAA,hDAACD;AADhB,AAEE,+DAAA,2CAAA,oEAAA,gBAAA,vLAACE,2QAGC,WAAKC;AAAL,AACE,oBAAM,iBAAAC,oBAAA,AAAAC,gBAAMN;AAAN,AAAA,oBAAAK;AAAoBN;;AAApBM;;;AAAN,OACM,wDAAA,AAAAC,xDAACC,wEAAoBP,eAAc,AAACQ,qBAAQT,MAAM,qBAAA,2CAAA,2DAAA,3HAACS,lHACnD,iQAAO,WAAKC,nRAEZ;AAFO,AACE,OAACC,sBAAOR,SAAS,AAAQO;UAC1BE;;AAJd;;GAJJ,sFAUE,WAAKC;AAAL,AACE,IAAMC,WAAS,AAACC,iBAAO,AAACC,kBAAOH;AAA/B,AACG,oBAAA,AAAAN,gBAAON;AAAP,OACM,wDAAA,AAAAM,xDAACC,wEAAoBP,eAAc,AAACQ,qBAAQK,UAAU,qBAAA,2CAAA,2DAAA,3HAACL,tHACvD,qQAAO,WAAKC,vRAEZ;AAFO,AACE,OAACC,sBAAOR,SAAS,AAAQO;UAC1BE;;AAJd;;GAZP,0FAkBE,WAAKP;AAAL,AACE,oBAAA,AAAAE,gBAAOJ;AAAP,AACE,OAAA,AAAAI,gBAAYJ;;AADd;;GAnBJ,yEAsBE,WAAKH;AAAL,AAAA,0FAAA,mDAAA,2CAAA,wDAAA,kCAAA,mDAAA,WAAAiB;AAAA,AAEe,2CAAAA,pCAACN,sBAAOV","names":["clj-yavl.viz/vega-lite-viz","spec","container-ref","reagent.core.atom","view-ref","reagent.core.create_class","_","and__5023__auto__","cljs.core/deref","js/module$node_modules$vega_embed$build$vega_embed.default","cljs.core/clj->js","res","cljs.core/reset!","js/console.error","this","new-spec","cljs.core/second","reagent.core/argv","p1__31231#"],"sourcesContent":["(ns clj-yavl.viz\n  (:require [reagent.core :as r]\n            [\"vega-embed\" :as vega-embed]))\n\n(defn vega-lite-viz [spec]\n  (let [container-ref (r/atom nil)\n        view-ref (r/atom nil)]\n    (r/create-class\n     {:display-name \"vega-lite-viz\"\n      :component-did-mount\n      (fn [_]\n        (when (and @container-ref spec)\n          (-> (vega-embed/default @container-ref (clj->js spec) (clj->js {:actions true}))\n              (.then (fn [res]\n                       (reset! view-ref (.-view res))))\n              (.catch js/console.error))))\n      :component-did-update\n      (fn [this]\n        (let [new-spec (second (r/argv this))]\n           (when @container-ref\n             (-> (vega-embed/default @container-ref (clj->js new-spec) (clj->js {:actions true}))\n                 (.then (fn [res]\n                          (reset! view-ref (.-view res))))\n                 (.catch js/console.error)))))\n      :component-will-unmount\n      (fn [_]\n        (when @view-ref\n          (.finalize @view-ref)))\n      :reagent-render\n      (fn [spec]\n        [:div {:class \"w-full h-full overflow-auto p-4\"\n               :ref #(reset! container-ref %)}])})))\n"]}