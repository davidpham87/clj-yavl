shadow$provide.module$node_modules$monaco_editor$esm$vs$editor$common$diff$defaultLinesDiffComputer$heuristicSequenceOptimizations = function(require, module, exports) {
  function optimizeSequenceDiffs(sequence1, sequence2, sequenceDiffs) {
    sequenceDiffs = joinSequenceDiffsByShifting(sequence1, sequence2, sequenceDiffs);
    sequenceDiffs = joinSequenceDiffsByShifting(sequence1, sequence2, sequenceDiffs);
    if (sequence1.getBoundaryScore && sequence2.getBoundaryScore) {
      for (let i = 0; i < sequenceDiffs.length; i++) {
        var prevDiff = i > 0 ? sequenceDiffs[i - 1] : void 0;
        const diff = sequenceDiffs[i], nextDiff = i + 1 < sequenceDiffs.length ? sequenceDiffs[i + 1] : void 0, seq1ValidRange = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(prevDiff ? prevDiff.seq1Range.start + 1 : 0, nextDiff ? nextDiff.seq1Range.endExclusive - 1 : sequence1.length);
        prevDiff = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(prevDiff ? prevDiff.seq2Range.start + 1 : 0, nextDiff ? nextDiff.seq2Range.endExclusive - 1 : sequence2.length);
        diff.seq1Range.isEmpty ? sequenceDiffs[i] = shiftDiffToBetterPosition(diff, sequence1, sequence2, seq1ValidRange, prevDiff) : diff.seq2Range.isEmpty && (sequenceDiffs[i] = shiftDiffToBetterPosition(diff.swap(), sequence2, sequence1, prevDiff, seq1ValidRange).swap());
      }
    }
    return sequenceDiffs;
  }
  function joinSequenceDiffsByShifting(sequence1, sequence2, sequenceDiffs) {
    if (sequenceDiffs.length === 0) {
      return sequenceDiffs;
    }
    const result = [];
    result.push(sequenceDiffs[0]);
    for (var i = 1; i < sequenceDiffs.length; i++) {
      var prevResult = result[result.length - 1], cur = sequenceDiffs[i];
      if (cur.seq1Range.isEmpty || cur.seq2Range.isEmpty) {
        var length = cur.seq1Range.start - prevResult.seq1Range.endExclusive, d = void 0;
        for (d = 1; d <= length && sequence1.getElement(cur.seq1Range.start - d) === sequence1.getElement(cur.seq1Range.endExclusive - d) && sequence2.getElement(cur.seq2Range.start - d) === sequence2.getElement(cur.seq2Range.endExclusive - d); d++) {
        }
        d--;
        if (d === length) {
          result[result.length - 1] = new require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.SequenceDiff(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(prevResult.seq1Range.start, cur.seq1Range.endExclusive - length), new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(prevResult.seq2Range.start, cur.seq2Range.endExclusive - length));
          continue;
        }
        cur = cur.delta(-d);
      }
      result.push(cur);
    }
    sequenceDiffs = [];
    for (i = 0; i < result.length - 1; i++) {
      prevResult = result[i + 1];
      cur = result[i];
      if (cur.seq1Range.isEmpty || cur.seq2Range.isEmpty) {
        length = prevResult.seq1Range.start - cur.seq1Range.endExclusive;
        for (d = 0; d < length && sequence1.isStronglyEqual(cur.seq1Range.start + d, cur.seq1Range.endExclusive + d) && sequence2.isStronglyEqual(cur.seq2Range.start + d, cur.seq2Range.endExclusive + d); d++) {
        }
        if (d === length) {
          result[i + 1] = new require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.SequenceDiff(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(cur.seq1Range.start + length, prevResult.seq1Range.endExclusive), new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(cur.seq2Range.start + length, prevResult.seq2Range.endExclusive));
          continue;
        }
        d > 0 && (cur = cur.delta(d));
      }
      sequenceDiffs.push(cur);
    }
    result.length > 0 && sequenceDiffs.push(result[result.length - 1]);
    return sequenceDiffs;
  }
  function shiftDiffToBetterPosition(diff, sequence1, sequence2, seq1ValidRange, seq2ValidRange) {
    for (var deltaBefore = 1; diff.seq1Range.start - deltaBefore >= seq1ValidRange.start && diff.seq2Range.start - deltaBefore >= seq2ValidRange.start && sequence2.isStronglyEqual(diff.seq2Range.start - deltaBefore, diff.seq2Range.endExclusive - deltaBefore) && deltaBefore < 100;) {
      deltaBefore++;
    }
    deltaBefore--;
    let deltaAfter = 0;
    for (; diff.seq1Range.start + deltaAfter < seq1ValidRange.endExclusive && diff.seq2Range.endExclusive + deltaAfter < seq2ValidRange.endExclusive && sequence2.isStronglyEqual(diff.seq2Range.start + deltaAfter, diff.seq2Range.endExclusive + deltaAfter) && deltaAfter < 100;) {
      deltaAfter++;
    }
    if (deltaBefore === 0 && deltaAfter === 0) {
      return diff;
    }
    seq1ValidRange = 0;
    seq2ValidRange = -1;
    for (deltaBefore = -deltaBefore; deltaBefore <= deltaAfter; deltaBefore++) {
      var seq2OffsetStart = diff.seq2Range.start + deltaBefore;
      const seq2OffsetEndExclusive = diff.seq2Range.endExclusive + deltaBefore;
      seq2OffsetStart = sequence1.getBoundaryScore(diff.seq1Range.start + deltaBefore) + sequence2.getBoundaryScore(seq2OffsetStart) + sequence2.getBoundaryScore(seq2OffsetEndExclusive);
      seq2OffsetStart > seq2ValidRange && (seq2ValidRange = seq2OffsetStart, seq1ValidRange = deltaBefore);
    }
    return diff.delta(seq1ValidRange);
  }
  function removeShortMatches(sequence1, sequence2, sequenceDiffs) {
    sequence1 = [];
    for (const s of sequenceDiffs) {
      (sequenceDiffs = sequence1[sequence1.length - 1]) ? s.seq1Range.start - sequenceDiffs.seq1Range.endExclusive <= 2 || s.seq2Range.start - sequenceDiffs.seq2Range.endExclusive <= 2 ? sequence1[sequence1.length - 1] = new require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.SequenceDiff(sequenceDiffs.seq1Range.join(s.seq1Range), sequenceDiffs.seq2Range.join(s.seq2Range)) : sequence1.push(s) : sequence1.push(s);
    }
    return sequence1;
  }
  function extendDiffsToEntireWordIfAppropriate(sequence1, sequence2, sequenceDiffs) {
    function maybePushWordToAdditional() {
      lastModifiedWord && (Math.max(lastModifiedWord.deleted, lastModifiedWord.added) + (lastModifiedWord.count - 1) > lastModifiedWord.s1Range.length - lastModifiedWord.deleted && additional.push(new require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.SequenceDiff(lastModifiedWord.s1Range, lastModifiedWord.s2Range)), lastModifiedWord = void 0);
    }
    const additional = [];
    let lastModifiedWord = void 0;
    for (const s of sequenceDiffs) {
      function processWord(s1Range, s2Range) {
        var _a, _b, _c, _d;
        if (!lastModifiedWord || !lastModifiedWord.s1Range.containsRange(s1Range) || !lastModifiedWord.s2Range.containsRange(s2Range)) {
          if (!lastModifiedWord || lastModifiedWord.s1Range.endExclusive < s1Range.start && lastModifiedWord.s2Range.endExclusive < s2Range.start) {
            maybePushWordToAdditional(), lastModifiedWord = {added:0, deleted:0, count:0, s1Range, s2Range};
          } else {
            const s1Added = require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange.tryCreate(lastModifiedWord.s1Range.endExclusive, s1Range.start), s2Added = require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange.tryCreate(lastModifiedWord.s2Range.endExclusive, s2Range.start);
            lastModifiedWord.deleted += (_a = s1Added === null || s1Added === void 0 ? void 0 : s1Added.length) !== null && _a !== void 0 ? _a : 0;
            lastModifiedWord.added += (_b = s2Added === null || s2Added === void 0 ? void 0 : s2Added.length) !== null && _b !== void 0 ? _b : 0;
            lastModifiedWord.s1Range = lastModifiedWord.s1Range.join(s1Range);
            lastModifiedWord.s2Range = lastModifiedWord.s2Range.join(s2Range);
          }
        }
        s1Range = s1Range.intersect(s.seq1Range);
        s2Range = s2Range.intersect(s.seq2Range);
        lastModifiedWord.count++;
        lastModifiedWord.deleted += (_c = s1Range === null || s1Range === void 0 ? void 0 : s1Range.length) !== null && _c !== void 0 ? _c : 0;
        lastModifiedWord.added += (_d = s2Range === null || s2Range === void 0 ? void 0 : s2Range.length) !== null && _d !== void 0 ? _d : 0;
      }
      const w1Before = sequence1.findWordContaining(s.seq1Range.start - 1), w2Before = sequence2.findWordContaining(s.seq2Range.start - 1), w1After = sequence1.findWordContaining(s.seq1Range.endExclusive), w2After = sequence2.findWordContaining(s.seq2Range.endExclusive);
      w1Before && w1After && w2Before && w2After && w1Before.equals(w1After) && w2Before.equals(w2After) ? processWord(w1Before, w2Before) : (w1Before && w2Before && processWord(w1Before, w2Before), w1After && w2After && processWord(w1After, w2After));
    }
    maybePushWordToAdditional();
    return mergeSequenceDiffs(sequenceDiffs, additional);
  }
  function mergeSequenceDiffs(sequenceDiffs1, sequenceDiffs2) {
    const result = [];
    for (; sequenceDiffs1.length > 0 || sequenceDiffs2.length > 0;) {
      var sd1 = sequenceDiffs1[0];
      const sd2 = sequenceDiffs2[0];
      sd1 = sd1 && (!sd2 || sd1.seq1Range.start < sd2.seq1Range.start) ? sequenceDiffs1.shift() : sequenceDiffs2.shift();
      result.length > 0 && result[result.length - 1].seq1Range.endExclusive >= sd1.seq1Range.start ? result[result.length - 1] = result[result.length - 1].join(sd1) : result.push(sd1);
    }
    return result;
  }
  function removeVeryShortMatchingLinesBetweenDiffs(sequence1, _sequence2, sequenceDiffs) {
    _sequence2 = sequenceDiffs;
    if (_sequence2.length === 0) {
      return _sequence2;
    }
    sequenceDiffs = 0;
    let shouldRepeat;
    do {
      shouldRepeat = !1;
      const result = [_sequence2[0]];
      for (let i = 1; i < _sequence2.length; i++) {
        const cur = _sequence2[i];
        var lastResult = result[result.length - 1];
        {
          const unchangedRange = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(lastResult.seq1Range.endExclusive, cur.seq1Range.start);
          lastResult = sequence1.getText(unchangedRange).replace(/\s/g, "").length <= 4 && (lastResult.seq1Range.length + lastResult.seq2Range.length > 5 || cur.seq1Range.length + cur.seq2Range.length > 5) ? !0 : !1;
        }
        lastResult ? (shouldRepeat = !0, result[result.length - 1] = result[result.length - 1].join(cur)) : result.push(cur);
      }
      _sequence2 = result;
    } while (sequenceDiffs++ < 10 && shouldRepeat);
    return _sequence2;
  }
  function removeVeryShortMatchingTextBetweenLongDiffs(sequence1, sequence2, sequenceDiffs) {
    if (sequenceDiffs.length === 0) {
      return sequenceDiffs;
    }
    let counter = 0, shouldRepeat;
    do {
      shouldRepeat = !1;
      const result = [sequenceDiffs[0]];
      for (let i = 1; i < sequenceDiffs.length; i++) {
        const cur = sequenceDiffs[i], lastResult = result[result.length - 1];
        (function(before, after) {
          var unchangedRange = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(lastResult.seq1Range.endExclusive, cur.seq1Range.start);
          if (sequence1.countLinesIn(unchangedRange) > 5 || unchangedRange.length > 500) {
            return !1;
          }
          unchangedRange = sequence1.getText(unchangedRange).trim();
          if (unchangedRange.length > 20 || unchangedRange.split(/\r\n|\r|\n/).length > 1) {
            return !1;
          }
          unchangedRange = sequence1.countLinesIn(before.seq1Range);
          const beforeSeq1Length = before.seq1Range.length, beforeLineCount2 = sequence2.countLinesIn(before.seq2Range);
          before = before.seq2Range.length;
          const afterLineCount1 = sequence1.countLinesIn(after.seq1Range), afterSeq1Length = after.seq1Range.length, afterLineCount2 = sequence2.countLinesIn(after.seq2Range);
          return Math.pow(Math.pow(Math.min(unchangedRange * 40 + beforeSeq1Length, 130), 1.5) + Math.pow(Math.min(beforeLineCount2 * 40 + before, 130), 1.5), 1.5) + Math.pow(Math.pow(Math.min(afterLineCount1 * 40 + afterSeq1Length, 130), 1.5) + Math.pow(Math.min(afterLineCount2 * 40 + after.seq2Range.length, 130), 1.5), 1.5) > (130 ** 1.5) ** 1.5 * 1.3 ? !0 : !1;
        })(lastResult, cur) ? (shouldRepeat = !0, result[result.length - 1] = result[result.length - 1].join(cur)) : result.push(cur);
      }
      sequenceDiffs = result;
    } while (counter++ < 10 && shouldRepeat);
    const newDiffs = [];
    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_arrays_DOT_js.forEachWithNeighbors)(sequenceDiffs, (prev, cur, next) => {
      function shouldMarkAsChanged(text) {
        return text.length > 0 && text.trim().length <= 3 && cur.seq1Range.length + cur.seq2Range.length > 100;
      }
      var newDiff = cur, fullRange1 = sequence1.extendToFullLines(cur.seq1Range);
      const prefix = sequence1.getText(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(fullRange1.start, cur.seq1Range.start));
      shouldMarkAsChanged(prefix) && (newDiff = newDiff.deltaStart(-prefix.length));
      fullRange1 = sequence1.getText(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js.OffsetRange(cur.seq1Range.endExclusive, fullRange1.endExclusive));
      shouldMarkAsChanged(fullRange1) && (newDiff = newDiff.deltaEnd(fullRange1.length));
      prev = require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.SequenceDiff.fromOffsetPairs(prev ? prev.getEndExclusives() : require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.OffsetPair.zero, next ? next.getStarts() : require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js.OffsetPair.max);
      newDiff = newDiff.intersect(prev);
      newDiffs.push(newDiff);
    });
    return newDiffs;
  }
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, extendDiffsToEntireWordIfAppropriate:{enumerable:!0, get:function() {
    return extendDiffsToEntireWordIfAppropriate;
  }}, optimizeSequenceDiffs:{enumerable:!0, get:function() {
    return optimizeSequenceDiffs;
  }}, removeShortMatches:{enumerable:!0, get:function() {
    return removeShortMatches;
  }}, removeVeryShortMatchingLinesBetweenDiffs:{enumerable:!0, get:function() {
    return removeVeryShortMatchingLinesBetweenDiffs;
  }}, removeVeryShortMatchingTextBetweenLongDiffs:{enumerable:!0, get:function() {
    return removeVeryShortMatchingTextBetweenLongDiffs;
  }}});
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_arrays_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$arrays"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH_core_SLASH_offsetRange_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$core$offsetRange"), require$_DOT__SLASH_algorithms_SLASH_diffAlgorithm_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$diff$defaultLinesDiffComputer$algorithms$diffAlgorithm");
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$editor$common$diff$defaultLinesDiffComputer$heuristicSequenceOptimizations.js.map
