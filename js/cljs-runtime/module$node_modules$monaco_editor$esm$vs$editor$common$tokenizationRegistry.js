shadow$provide.module$node_modules$monaco_editor$esm$vs$editor$common$tokenizationRegistry = function(require, module, exports) {
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, TokenizationRegistry:{enumerable:!0, get:function() {
    return TokenizationRegistry;
  }}});
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$event"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$lifecycle");
  class TokenizationRegistry {
    constructor() {
      this._tokenizationSupports = new Map();
      this._factories = new Map();
      this._onDidChange = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Emitter();
      this.onDidChange = this._onDidChange.event;
      this._colorMap = null;
    }
    handleChange(languageIds) {
      this._onDidChange.fire({changedLanguages:languageIds, changedColorMap:!1});
    }
    register(languageId, support) {
      this._tokenizationSupports.set(languageId, support);
      this.handleChange([languageId]);
      return (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => {
        this._tokenizationSupports.get(languageId) === support && (this._tokenizationSupports.delete(languageId), this.handleChange([languageId]));
      });
    }
    get(languageId) {
      return this._tokenizationSupports.get(languageId) || null;
    }
    registerFactory(languageId, factory) {
      var _a;
      (_a = this._factories.get(languageId)) === null || _a === void 0 || _a.dispose();
      const myData = new TokenizationSupportFactoryData(this, languageId, factory);
      this._factories.set(languageId, myData);
      return (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => {
        const v = this._factories.get(languageId);
        v && v === myData && (this._factories.delete(languageId), v.dispose());
      });
    }
    async getOrCreate(languageId) {
      var tokenizationSupport = this.get(languageId);
      if (tokenizationSupport) {
        return tokenizationSupport;
      }
      tokenizationSupport = this._factories.get(languageId);
      if (!tokenizationSupport || tokenizationSupport.isResolved) {
        return null;
      }
      await tokenizationSupport.resolve();
      return this.get(languageId);
    }
    isResolved(languageId) {
      if (this.get(languageId)) {
        return !0;
      }
      languageId = this._factories.get(languageId);
      return !languageId || languageId.isResolved ? !0 : !1;
    }
    setColorMap(colorMap) {
      this._colorMap = colorMap;
      this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()), changedColorMap:!0});
    }
    getColorMap() {
      return this._colorMap;
    }
    getDefaultBackground() {
      return this._colorMap && this._colorMap.length > 2 ? this._colorMap[2] : null;
    }
  }
  class TokenizationSupportFactoryData extends require$_DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.Disposable {
    get isResolved() {
      return this._isResolved;
    }
    constructor(_registry, _languageId, _factory) {
      super();
      this._registry = _registry;
      this._languageId = _languageId;
      this._factory = _factory;
      this._isDisposed = !1;
      this._resolvePromise = null;
      this._isResolved = !1;
    }
    dispose() {
      this._isDisposed = !0;
      super.dispose();
    }
    async resolve() {
      this._resolvePromise || (this._resolvePromise = this._create());
      return this._resolvePromise;
    }
    async _create() {
      const value = await this._factory.tokenizationSupport;
      this._isResolved = !0;
      value && !this._isDisposed && this._register(this._registry.register(this._languageId, value));
    }
  }
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$editor$common$tokenizationRegistry.js.map
