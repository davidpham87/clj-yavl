shadow$provide.module$node_modules$monaco_editor$esm$vs$platform$quickinput$browser$quickAccess = function(require, module, exports) {
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, QuickAccessController:{enumerable:!0, get:function() {
    return QuickAccessController;
  }}});
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_async_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$async"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_cancellation_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$cancellation"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$event"), 
  require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$lifecycle");
  module = require("module$node_modules$monaco_editor$esm$vs$platform$instantiation$common$instantiation");
  var require$_DOT__DOT__SLASH_common_SLASH_quickAccess_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$quickinput$common$quickAccess"), require$_DOT__DOT__SLASH_common_SLASH_quickInput_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$quickinput$common$quickInput"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH_registry_SLASH_common_SLASH_platform_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$registry$common$platform");
  require = this && this.__param || function(paramIndex, decorator) {
    return function(target, key) {
      decorator(target, key, paramIndex);
    };
  };
  let QuickAccessController = class extends require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.Disposable {
    constructor(quickInputService, instantiationService) {
      super();
      this.quickInputService = quickInputService;
      this.instantiationService = instantiationService;
      this.registry = require$_DOT__DOT__SLASH__DOT__DOT__SLASH_registry_SLASH_common_SLASH_platform_DOT_js.Registry.as(require$_DOT__DOT__SLASH_common_SLASH_quickAccess_DOT_js.Extensions.Quickaccess);
      this.mapProviderToDescriptor = new Map();
      this.lastAcceptedPickerValues = new Map();
      this.visibleQuickAccess = void 0;
    }
    show(value = "", options) {
      this.doShowOrPick(value, !1, options);
    }
    doShowOrPick(value, pick, options) {
      var _a;
      const [provider, descriptor] = this.getOrInstantiateProvider(value), visibleQuickAccess = this.visibleQuickAccess;
      var visibleDescriptor = visibleQuickAccess === null || visibleQuickAccess === void 0 ? void 0 : visibleQuickAccess.descriptor;
      if (visibleQuickAccess && descriptor && visibleDescriptor === descriptor) {
        value === descriptor.prefix || options !== null && options !== void 0 && options.preserveValue || (visibleQuickAccess.picker.value = value), this.adjustValueSelection(visibleQuickAccess.picker, descriptor, options);
      } else {
        if (descriptor && (options === null || options === void 0 || !options.preserveValue)) {
          let newValue = void 0;
          visibleQuickAccess && visibleDescriptor && visibleDescriptor !== descriptor && (visibleDescriptor = visibleQuickAccess.value.substr(visibleDescriptor.prefix.length)) && (newValue = `${descriptor.prefix}${visibleDescriptor}`);
          newValue || (visibleDescriptor = provider === null || provider === void 0 ? void 0 : provider.defaultFilterValue, visibleDescriptor === require$_DOT__DOT__SLASH_common_SLASH_quickAccess_DOT_js.DefaultQuickAccessFilterValue.LAST ? newValue = this.lastAcceptedPickerValues.get(descriptor) : typeof visibleDescriptor === "string" && (newValue = `${descriptor.prefix}${visibleDescriptor}`));
          typeof newValue === "string" && (value = newValue);
        }
        var disposables = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.DisposableStore(), picker = disposables.add(this.quickInputService.createQuickPick());
        picker.value = value;
        this.adjustValueSelection(picker, descriptor, options);
        picker.placeholder = descriptor === null || descriptor === void 0 ? void 0 : descriptor.placeholder;
        picker.quickNavigate = options === null || options === void 0 ? void 0 : options.quickNavigateConfiguration;
        picker.hideInput = !!picker.quickNavigate && !visibleQuickAccess;
        if (typeof(options === null || options === void 0 ? void 0 : options.itemActivation) === "number" || (options === null || options === void 0 ? 0 : options.quickNavigateConfiguration)) {
          picker.itemActivation = (_a = options === null || options === void 0 ? void 0 : options.itemActivation) !== null && _a !== void 0 ? _a : require$_DOT__DOT__SLASH_common_SLASH_quickInput_DOT_js.ItemActivation.SECOND;
        }
        picker.contextKey = descriptor === null || descriptor === void 0 ? void 0 : descriptor.contextKey;
        picker.filterValue = value => value.substring(descriptor ? descriptor.prefix.length : 0);
        var pickPromise = void 0;
        pick && (pickPromise = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_async_DOT_js.DeferredPromise(), disposables.add(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Event.once(picker.onWillAccept)(e => {
          e.veto();
          picker.hide();
        })));
        disposables.add(this.registerPickerListeners(picker, provider, descriptor, value, options === null || options === void 0 ? void 0 : options.providerOptions));
        var cts = disposables.add(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_cancellation_DOT_js.CancellationTokenSource());
        provider && disposables.add(provider.provide(picker, cts.token, options === null || options === void 0 ? void 0 : options.providerOptions));
        require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Event.once(picker.onDidHide)(() => {
          picker.selectedItems.length === 0 && cts.cancel();
          disposables.dispose();
          pickPromise === null || pickPromise === void 0 || pickPromise.complete(picker.selectedItems.slice(0));
        });
        picker.show();
        if (pick) {
          return pickPromise === null || pickPromise === void 0 ? void 0 : pickPromise.p;
        }
      }
    }
    adjustValueSelection(picker, descriptor, options) {
      var _a;
      descriptor = (options === null || options === void 0 ? 0 : options.preserveValue) ? [picker.value.length, picker.value.length] : [(_a = descriptor === null || descriptor === void 0 ? void 0 : descriptor.prefix.length) !== null && _a !== void 0 ? _a : 0, picker.value.length];
      picker.valueSelection = descriptor;
    }
    registerPickerListeners(picker, provider, descriptor, value, providerOptions) {
      const disposables = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.DisposableStore(), visibleQuickAccess = this.visibleQuickAccess = {picker, descriptor, value};
      disposables.add((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => {
        visibleQuickAccess === this.visibleQuickAccess && (this.visibleQuickAccess = void 0);
      }));
      disposables.add(picker.onDidChangeValue(value => {
        const [providerForValue] = this.getOrInstantiateProvider(value);
        providerForValue !== provider ? this.show(value, {preserveValue:!0, providerOptions}) : visibleQuickAccess.value = value;
      }));
      descriptor && disposables.add(picker.onDidAccept(() => {
        this.lastAcceptedPickerValues.set(descriptor, picker.value);
      }));
      return disposables;
    }
    getOrInstantiateProvider(value) {
      value = this.registry.getQuickAccessProvider(value);
      if (!value) {
        return [void 0, void 0];
      }
      let provider = this.mapProviderToDescriptor.get(value);
      provider || (provider = this.instantiationService.createInstance(value.ctor), this.mapProviderToDescriptor.set(value, provider));
      return [provider, value];
    }
  };
  QuickAccessController = (this && this.__decorate || function(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") {
      r = Reflect.decorate(decorators, target, key, desc);
    } else {
      for (var i = decorators.length - 1; i >= 0; i--) {
        if (d = decorators[i]) {
          r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        }
      }
    }
    return c > 3 && r && Object.defineProperty(target, key, r), r;
  })([require(0, require$_DOT__DOT__SLASH_common_SLASH_quickInput_DOT_js.IQuickInputService), require(1, module.IInstantiationService)], QuickAccessController);
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$platform$quickinput$browser$quickAccess.js.map
