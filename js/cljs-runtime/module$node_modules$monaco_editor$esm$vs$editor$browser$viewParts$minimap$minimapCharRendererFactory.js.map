{
"version":3,
"file":"module$node_modules$monaco_editor$esm$vs$editor$browser$viewParts$minimap$minimapCharRendererFactory.js",
"lineCount":78,
"mappings":"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",
"sources":["node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$monaco_editor$esm$vs$editor$browser$viewParts$minimap$minimapCharRendererFactory\"] = function(require,module,exports) {\nObject.defineProperties(exports, {__esModule:{enumerable:true, value:true}, MinimapCharRendererFactory:{enumerable:true, get:function() {\n  return MinimapCharRendererFactory;\n}}});\nvar require$_DOT__SLASH_minimapCharRenderer_DOT_js = require(\"./minimapCharRenderer.js\");\nvar require$_DOT__SLASH_minimapCharSheet_DOT_js = require(\"./minimapCharSheet.js\");\nvar require$_DOT__SLASH_minimapPreBaked_DOT_js = require(\"./minimapPreBaked.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_uint_DOT_js = require(\"../../../../base/common/uint.js\");\nclass MinimapCharRendererFactory {\n  static create(scale, fontFamily) {\n    if (this.lastCreated && scale === this.lastCreated.scale && fontFamily === this.lastFontFamily) {\n      return this.lastCreated;\n    }\n    let factory;\n    if (require$_DOT__SLASH_minimapPreBaked_DOT_js.prebakedMiniMaps[scale]) {\n      factory = new require$_DOT__SLASH_minimapCharRenderer_DOT_js.MinimapCharRenderer(require$_DOT__SLASH_minimapPreBaked_DOT_js.prebakedMiniMaps[scale](), scale);\n    } else {\n      factory = MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(fontFamily).data, scale);\n    }\n    this.lastFontFamily = fontFamily;\n    this.lastCreated = factory;\n    return factory;\n  }\n  static createSampleData(fontFamily) {\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    canvas.style.height = `${16}px`;\n    canvas.height = 16;\n    canvas.width = 96 * 10;\n    canvas.style.width = 96 * 10 + \"px\";\n    ctx.fillStyle = \"#ffffff\";\n    ctx.font = `bold ${16}px ${fontFamily}`;\n    ctx.textBaseline = \"middle\";\n    let x = 0;\n    for (const code of require$_DOT__SLASH_minimapCharSheet_DOT_js.allCharCodes) {\n      ctx.fillText(String.fromCharCode(code), x, 16 / 2);\n      x += 10;\n    }\n    return ctx.getImageData(0, 0, 96 * 10, 16);\n  }\n  static createFromSampleData(source, scale) {\n    const expectedLength = 16 * 10 * 4 * 96;\n    if (source.length !== expectedLength) {\n      throw new Error(\"Unexpected source in MinimapCharRenderer\");\n    }\n    const charData = MinimapCharRendererFactory._downsample(source, scale);\n    return new require$_DOT__SLASH_minimapCharRenderer_DOT_js.MinimapCharRenderer(charData, scale);\n  }\n  static _downsampleChar(source, sourceOffset, dest, destOffset, scale) {\n    const width = 1 * scale;\n    const height = 2 * scale;\n    let targetIndex = destOffset;\n    let brightest = 0;\n    for (let y = 0; y < height; y++) {\n      const sourceY1 = y / height * 16;\n      const sourceY2 = (y + 1) / height * 16;\n      for (let x = 0; x < width; x++) {\n        const sourceX1 = x / width * 10;\n        const sourceX2 = (x + 1) / width * 10;\n        let value = 0;\n        let samples = 0;\n        for (let sy = sourceY1; sy < sourceY2; sy++) {\n          const sourceRow = sourceOffset + Math.floor(sy) * 3840;\n          const yBalance = 1 - (sy - Math.floor(sy));\n          for (let sx = sourceX1; sx < sourceX2; sx++) {\n            const xBalance = 1 - (sx - Math.floor(sx));\n            const sourceIndex = sourceRow + Math.floor(sx) * 4;\n            const weight = xBalance * yBalance;\n            samples += weight;\n            value += source[sourceIndex] * source[sourceIndex + 3] / 255 * weight;\n          }\n        }\n        const final = value / samples;\n        brightest = Math.max(brightest, final);\n        dest[targetIndex++] = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_uint_DOT_js.toUint8)(final);\n      }\n    }\n    return brightest;\n  }\n  static _downsample(data, scale) {\n    const pixelsPerCharacter = 2 * scale * 1 * scale;\n    const resultLen = pixelsPerCharacter * 96;\n    const result = new Uint8ClampedArray(resultLen);\n    let resultOffset = 0;\n    let sourceOffset = 0;\n    let brightest = 0;\n    for (let charIndex = 0; charIndex < 96; charIndex++) {\n      brightest = Math.max(brightest, this._downsampleChar(data, sourceOffset, result, resultOffset, scale));\n      resultOffset += pixelsPerCharacter;\n      sourceOffset += 10 * 4;\n    }\n    if (brightest > 0) {\n      const adjust = 255 / brightest;\n      for (let i = 0; i < resultLen; i++) {\n        result[i] *= adjust;\n      }\n    }\n    return result;\n  }\n}\n\n};"],
"names":["shadow$provide","require","module","exports","Object","defineProperties","__esModule","enumerable","value","MinimapCharRendererFactory","get","require$_DOT__SLASH_minimapCharRenderer_DOT_js","require$_DOT__SLASH_minimapCharSheet_DOT_js","require$_DOT__SLASH_minimapPreBaked_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_uint_DOT_js","create","scale","fontFamily","lastCreated","lastFontFamily","factory","prebakedMiniMaps","MinimapCharRenderer","createFromSampleData","createSampleData","data","canvas","document","createElement","ctx","getContext","style","height","width","fillStyle","font","textBaseline","x","code","allCharCodes","fillText","String","fromCharCode","getImageData","source","length","expectedLength","Error","charData","_downsample","_downsampleChar","sourceOffset","dest","destOffset","brightest","y","sourceY1","sourceY2","sourceX1","sourceX2","samples","sy","sourceRow","Math","floor","yBalance","sx","sourceIndex","weight","final","max","targetIndex","toUint8","pixelsPerCharacter","resultLen","result","Uint8ClampedArray","resultOffset","charIndex","adjust","i"]
}
