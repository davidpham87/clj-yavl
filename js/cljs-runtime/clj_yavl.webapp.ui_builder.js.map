{"version":3,"sources":["clj_yavl/webapp/ui_builder.cljs"],"mappings":"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","names":["js/clj-yavl","js/clj-yavl.webapp","js/clj-yavl.webapp.ui-builder","js/clj-yavl.webapp.ui-builder.render-input","method-table__5622__auto__","cljs.core.atom","prefer-table__5623__auto__","method-cache__5624__auto__","cached-hierarchy__5625__auto__","hierarchy__5626__auto__","cljs.core.get","fexpr__29821","cljs.core/MultiFn","cljs.core.symbol","clj-yavl.webapp.ui-builder/render-input","p__29822","map__29823","cljs.core/--destructure-map","conf","p__29825","map__29826","p1__29824#","arg","prop","current-opts","cljs.core.get_in","val","cljs.core._EQ_","re-frame.core/dispatch","iter__5503__auto__","s__29828","cljs.core/LazySeq","temp__5825__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5501__auto__","size__5502__auto__","cljs.core/count","b__29830","cljs.core/chunk-buffer","i__29829","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__29827","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","opt","p__29833","map__29834","p1__29831#","p__29836","map__29837","p1__29835#","js/parseFloat","p__29839","map__29840","p1__29838#","p__29841","map__29842","s__29844","b__29846","i__29845","iter__29843","_","clj-yavl.webapp.ui-builder/render-ui-builder-item","item","cljs.core/name","cljs.core.into","s__29852","b__29854","i__29853","vec__29859","cljs.core.nth","iter__29851","vec__29862","clj-yavl.webapp.ui-builder/ui-builder-view","cljs.core/deref","p1__29869#","preset-key","re_frame.core.subscribe","inferred-schema","schema","or__5025__auto__","ui-def","clj_yavl.webapp.ui_schema.generate_ui_schema","sb__5670__auto__","goog.string/StringBuffer","*print-newline*-orig-val__29870","cljs.core/*print-newline*","*print-fn*-orig-val__29871","cljs.core/*print-fn*","*print-newline*-temp-val__29872","*print-fn*-temp-val__29873","x__5671__auto__","cljs.pprint.pprint","cljs.core.keyword","s__29879","b__29881","i__29880","iter__29878","cljs.core/chunk-first"],"sourcesContent":["(ns clj-yavl.webapp.ui-builder\n  (:require\n   [clj-yavl.webapp.events :as events]\n   [clj-yavl.webapp.subs :as subs]\n   [clj-yavl.webapp.ui-schema :as ui-schema]\n   [cljs.pprint :refer [pprint]]\n   [re-frame.core :as rf]))\n\n(defmulti render-input (fn [{:keys [conf]}] (:type conf)))\n\n(defmethod render-input :select\n  [{:keys [arg prop conf current-opts]}]\n  [:select {:class \"bg-gray-800 border border-gray-600 text-xs p-1\"\n            :value (get-in current-opts [arg prop])\n            :on-change #(let [val (-> % .-target .-value)]\n                          (if (= prop :field)\n                            (rf/dispatch [::events/update-field-selection arg prop val])\n                            (rf/dispatch [::events/update-ui-option arg prop val])))}\n   [:option {:value \"\"} \"-\"]\n   (for [opt (:options conf)]\n     ^{:key opt}\n     [:option {:value opt} opt])])\n\n(defmethod render-input :text-input\n  [{:keys [arg prop current-opts]}]\n  [:input {:type \"text\"\n           :class \"bg-gray-800 border border-gray-600 text-xs p-1\"\n           :value (get-in current-opts [arg prop])\n           :on-change #(rf/dispatch [::events/update-ui-option arg prop (-> % .-target .-value)])}])\n\n(defmethod render-input :number-input\n  [{:keys [arg prop current-opts]}]\n  [:input {:type \"number\"\n           :class \"bg-gray-800 border border-gray-600 text-xs p-1\"\n           :value (get-in current-opts [arg prop])\n           :on-change #(rf/dispatch [::events/update-ui-option arg prop (js/parseFloat (-> % .-target .-value))])}])\n\n(defmethod render-input :boolean\n  [{:keys [arg prop current-opts]}]\n  [:input {:type \"checkbox\"\n           :checked (get-in current-opts [arg prop])\n           :on-change #(rf/dispatch [::events/update-ui-option arg prop (-> % .-target .-checked)])}])\n\n(defmethod render-input :multi-select\n  [{:keys [conf]}]\n  [:select {:multiple true :class \"bg-gray-800 border border-gray-600 text-xs p-1 h-20\"}\n   (for [opt (:options conf)]\n     ^{:key opt}\n     [:option {:value opt} opt])])\n\n(defmethod render-input :json-editor\n  [_]\n  [:textarea {:class \"bg-gray-800 border border-gray-600 text-xs p-1 h-10\" :placeholder \"JSON...\"}])\n\n(defmethod render-input :default\n  [_]\n  nil)\n\n(defn- render-ui-builder-item [item current-opts]\n  [:div {:class \"border border-gray-600 p-2 rounded\"}\n    [:div {:class \"font-bold text-sm mb-2 text-blue-400\"}\n    (name (:arg item))\n    [:span {:class \"text-gray-500 text-xs ml-2\"} (name (:scope item))]]\n\n    (into [:div {:class \"grid grid-cols-2 gap-2\"}]\n          (for [[prop conf] (:main item)]\n            [:div {:class \"flex flex-col\"}\n            [:label {:class \"text-xs mb-1\"} (name prop)]\n            (render-input {:arg (:arg item)\n                            :item item\n                            :prop prop\n                            :conf conf\n                            :current-opts current-opts})]))])\n\n(defn ui-builder-view []\n  (let [preset-key @(rf/subscribe [::subs/ui-builder-preset])\n        current-opts @(rf/subscribe [::subs/ui-builder-opts])\n        inferred-schema @(rf/subscribe [::subs/inferred-schema])\n        schema (or inferred-schema [:map [:Name :string]])\n        ui-def (ui-schema/generate-ui-schema preset-key schema current-opts)]\n    [:div {:class \"p-4 text-gray-300 overflow-auto h-full bg-[#1e1e1e]\"}\n     [:h2 {:class \"text-lg font-bold mb-4\"} \"UI Builder\"]\n     (when inferred-schema\n       [:div {:class \"mb-4 text-green-400 text-xs\"}\n        \"Schema inferred from loaded dataset.\"\n        [:div {:class \"mb-4 p-2 bg-gray-800 rounded text-xs font-mono whitespace-pre-wrap\"}\n        (with-out-str (cljs.pprint/pprint schema))]])\n     [:div {:class \"mb-4\"}\n      [:label \"Preset: \"]\n      [:select {:class \"bg-gray-700 text-white p-1\"\n                :value preset-key\n                :on-change #(rf/dispatch [::events/set-ui-preset (keyword (-> % .-target .-value))])}\n       [:option {:value \"xyplot\"} \"XY Plot\"]\n       [:option {:value \"pie\"} \"Pie Chart\"]\n       [:option {:value \"bar\"} \"Bar Chart\"]]]\n\n     [:div {:class \"space-y-4\"}\n      (into [:<>]\n            (for [item ui-def]\n              ^{:key (:arg item)}\n              (render-ui-builder-item item current-opts)))]]))\n"]}