shadow$provide.module$node_modules$monaco_editor$esm$vs$editor$browser$config$fontMeasurements = function(require, module, exports) {
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, FontMeasurements:{enumerable:!0, get:function() {
    return FontMeasurements;
  }}, FontMeasurementsImpl:{enumerable:!0, get:function() {
    return FontMeasurementsImpl;
  }}});
  var browser = require("module$node_modules$monaco_editor$esm$vs$base$browser$browser"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_window_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$browser$window"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$event");
  module = require("module$node_modules$monaco_editor$esm$vs$base$common$lifecycle");
  var require$_DOT__SLASH_charWidthReader_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$config$charWidthReader"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_config_SLASH_editorOptions_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$config$editorOptions"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_config_SLASH_fontInfo_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$config$fontInfo");
  class FontMeasurementsImpl extends module.Disposable {
    constructor() {
      super();
      this._onDidChange = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Emitter());
      this.onDidChange = this._onDidChange.event;
      this._cache = new FontMeasurementsCache();
      this._evictUntrustedReadingsTimeout = -1;
    }
    dispose() {
      this._evictUntrustedReadingsTimeout !== -1 && (clearTimeout(this._evictUntrustedReadingsTimeout), this._evictUntrustedReadingsTimeout = -1);
      super.dispose();
    }
    clearAllFontInfos() {
      this._cache = new FontMeasurementsCache();
      this._onDidChange.fire();
    }
    _writeToCache(item, value) {
      this._cache.put(item, value);
      value.isTrusted || this._evictUntrustedReadingsTimeout !== -1 || (this._evictUntrustedReadingsTimeout = require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_window_DOT_js.mainWindow.setTimeout(() => {
        this._evictUntrustedReadingsTimeout = -1;
        this._evictUntrustedReadings();
      }, 5000));
    }
    _evictUntrustedReadings() {
      const values = this._cache.getValues();
      let somethingRemoved = !1;
      for (const item of values) {
        item.isTrusted || (somethingRemoved = !0, this._cache.remove(item));
      }
      somethingRemoved && this._onDidChange.fire();
    }
    readFontInfo(bareFontInfo) {
      if (!this._cache.has(bareFontInfo)) {
        let readConfig = this._actualReadFontInfo(bareFontInfo);
        if (readConfig.typicalHalfwidthCharacterWidth <= 2 || readConfig.typicalFullwidthCharacterWidth <= 2 || readConfig.spaceWidth <= 2 || readConfig.maxDigitWidth <= 2) {
          readConfig = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_config_SLASH_fontInfo_DOT_js.FontInfo({pixelRatio:browser.PixelRatio.value, fontFamily:readConfig.fontFamily, fontWeight:readConfig.fontWeight, fontSize:readConfig.fontSize, fontFeatureSettings:readConfig.fontFeatureSettings, fontVariationSettings:readConfig.fontVariationSettings, lineHeight:readConfig.lineHeight, letterSpacing:readConfig.letterSpacing, isMonospace:readConfig.isMonospace, typicalHalfwidthCharacterWidth:Math.max(readConfig.typicalHalfwidthCharacterWidth, 
          5), typicalFullwidthCharacterWidth:Math.max(readConfig.typicalFullwidthCharacterWidth, 5), canUseHalfwidthRightwardsArrow:readConfig.canUseHalfwidthRightwardsArrow, spaceWidth:Math.max(readConfig.spaceWidth, 5), middotWidth:Math.max(readConfig.middotWidth, 5), wsmiddotWidth:Math.max(readConfig.wsmiddotWidth, 5), maxDigitWidth:Math.max(readConfig.maxDigitWidth, 5)}, !1);
        }
        this._writeToCache(bareFontInfo, readConfig);
      }
      return this._cache.get(bareFontInfo);
    }
    _createRequest(chr, type, all, monospace) {
      chr = new require$_DOT__SLASH_charWidthReader_DOT_js.CharWidthRequest(chr, type);
      all.push(chr);
      monospace === null || monospace === void 0 || monospace.push(chr);
      return chr;
    }
    _actualReadFontInfo(bareFontInfo) {
      var all = [], monospace = [];
      const typicalHalfwidthCharacter = this._createRequest("n", 0, all, monospace), typicalFullwidthCharacter = this._createRequest("ｍ", 0, all, null), space = this._createRequest(" ", 0, all, monospace);
      var digit0 = this._createRequest("0", 0, all, monospace), digit1 = this._createRequest("1", 0, all, monospace), digit2 = this._createRequest("2", 0, all, monospace);
      const digit3 = this._createRequest("3", 0, all, monospace), digit4 = this._createRequest("4", 0, all, monospace), digit5 = this._createRequest("5", 0, all, monospace), digit6 = this._createRequest("6", 0, all, monospace), digit7 = this._createRequest("7", 0, all, monospace), digit8 = this._createRequest("8", 0, all, monospace), digit9 = this._createRequest("9", 0, all, monospace), rightwardsArrow = this._createRequest("→", 0, all, monospace), halfwidthRightwardsArrow = this._createRequest("￫", 
      0, all, null), middot = this._createRequest("·", 0, all, monospace), wsmiddotWidth = this._createRequest(String.fromCharCode(11825), 0, all, null);
      for (let i = 0, len = 8; i < len; i++) {
        this._createRequest("|/-_ilm%".charAt(i), 0, all, monospace), this._createRequest("|/-_ilm%".charAt(i), 1, all, monospace), this._createRequest("|/-_ilm%".charAt(i), 2, all, monospace);
      }
      (0,require$_DOT__SLASH_charWidthReader_DOT_js.readCharWidths)(bareFontInfo, all);
      all = Math.max(digit0.width, digit1.width, digit2.width, digit3.width, digit4.width, digit5.width, digit6.width, digit7.width, digit8.width, digit9.width);
      digit0 = bareFontInfo.fontFeatureSettings === require$_DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_config_SLASH_editorOptions_DOT_js.EditorFontLigatures.OFF;
      digit1 = monospace[0].width;
      for (let i = 1, len = monospace.length; digit0 && i < len; i++) {
        if (digit2 = digit1 - monospace[i].width, digit2 < -0.001 || digit2 > 0.001) {
          digit0 = !1;
          break;
        }
      }
      monospace = !0;
      digit0 && halfwidthRightwardsArrow.width !== digit1 && (monospace = !1);
      halfwidthRightwardsArrow.width > rightwardsArrow.width && (monospace = !1);
      return new require$_DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_config_SLASH_fontInfo_DOT_js.FontInfo({pixelRatio:browser.PixelRatio.value, fontFamily:bareFontInfo.fontFamily, fontWeight:bareFontInfo.fontWeight, fontSize:bareFontInfo.fontSize, fontFeatureSettings:bareFontInfo.fontFeatureSettings, fontVariationSettings:bareFontInfo.fontVariationSettings, lineHeight:bareFontInfo.lineHeight, letterSpacing:bareFontInfo.letterSpacing, isMonospace:digit0, typicalHalfwidthCharacterWidth:typicalHalfwidthCharacter.width, 
      typicalFullwidthCharacterWidth:typicalFullwidthCharacter.width, canUseHalfwidthRightwardsArrow:monospace, spaceWidth:space.width, middotWidth:middot.width, wsmiddotWidth:wsmiddotWidth.width, maxDigitWidth:all}, !0);
    }
  }
  class FontMeasurementsCache {
    constructor() {
      this._keys = Object.create(null);
      this._values = Object.create(null);
    }
    has(item) {
      item = item.getId();
      return !!this._values[item];
    }
    get(item) {
      item = item.getId();
      return this._values[item];
    }
    put(item, value) {
      const itemId = item.getId();
      this._keys[itemId] = item;
      this._values[itemId] = value;
    }
    remove(item) {
      item = item.getId();
      delete this._keys[item];
      delete this._values[item];
    }
    getValues() {
      return Object.keys(this._keys).map(id => this._values[id]);
    }
  }
  const FontMeasurements = new FontMeasurementsImpl();
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$editor$browser$config$fontMeasurements.js.map
