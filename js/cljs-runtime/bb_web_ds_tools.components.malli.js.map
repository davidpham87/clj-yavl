{"version":3,"sources":["bb_web_ds_tools/components/malli.cljc"],"mappings":"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","names":["bb-web-ds-tools.components.malli/parse-int","s","js/parseInt","bb-web-ds-tools.components.malli/read-edn","cljs.reader.read_string","bb-web-ds-tools.components.malli/parse-json","cljs.core.js__GT_clj","js/JSON.parse","bb-web-ds-tools.components.malli/generate-json","data","js/JSON.stringify","cljs.core/clj->js","bb-web-ds-tools.components.malli/pretty-print-str","sb__5670__auto__","goog.string/StringBuffer","*print-newline*-orig-val__42107","cljs.core/*print-newline*","*print-fn*-orig-val__42108","cljs.core/*print-fn*","*print-newline*-temp-val__42109","*print-fn*-temp-val__42110","x__5671__auto__","cljs.pprint.pprint","bb-web-ds-tools.components.malli/detect-and-parse","text","clojure.string/blank?","e42111","_","e42112","bb-web-ds-tools.components.malli/parse-schema-and-generate","schema-text","e42114","schema","e","cljs.core/ex-message","bb-web-ds-tools.components.malli/generate-data","samples","format","and__5023__auto__","cljs.core/vec","cljs.core.repeatedly","malli.generator.generate","output","G__42115","cljs.core/Keyword","cljs.core.pr_str","bb-web-ds-tools.components.malli/annotate-schema","cljs.core/vector?","cljs.core._EQ_","cljs.core/first","vec__42117","seq__42118","cljs.core/seq","first__42119","cljs.core/next","vec__42120","cljs.core.nth","type","tail","props","entries","cljs.core/map?","cljs.core/rest","maps","cljs.core.filter","cljs.core.mapv","entry","vec__42123","has-props?","cljs.core/second","k","p","v-schema","vals","p1__42116#","cljs.core.map","cljs.core.get","child-node","G__42127","fexpr__42126","vec__42128","child-schema","child-data","cljs.core/every?","cljs.core/coll?","cljs.core.mapcat","cljs.core/identity","vec__42134","cljs.core.remove","cljs.core/nil?","bb-web-ds-tools.components.malli/deannotate-schema","tree","clojure.walk/postwalk","node","G__42137","cljs.core.into","bb-web-ds-tools.components.malli/refine-schema-with-data","max-values","annotated","refined","d","s-type","strings","cljs.core/string?","distinct-vals","cljs.core.distinct","cnt","cljs.core/count","cljs.core.assoc","cljs.core.sort","fexpr__42138","nums","cljs.core/number?","min-val","cljs.core.apply","cljs.core/min","max-val","cljs.core/max","existing-props","new-props","cljs.core.merge","new-schema","dates","cljs.core/inst?","sorted","cljs.core/last","var_args","G__42140","bb-web-ds-tools.components.malli/infer-schema","js/Error","input-data","bb_web_ds_tools.components.malli.infer_schema","max-enum-values","malli.provider.provide","refined-schema","bb-web-ds-tools.components.malli/save-dataset-data","generated-data","G__42141","e42142","e42143","bb-web-ds-tools.components.malli/validate-data","malli.core.validate","malli.core.explain","bb-web-ds-tools.components.malli/transform-to-json-schema","e42144","malli.json_schema.transform","p__42145","map__42146","cljs.core/--destructure-map","bb-web-ds-tools.components.malli/inference-panel","values","handle-change","on-infer","inferred-schema","bb-web-ds-tools.components.common/card","bb-web-ds-tools.components.common/label","bb-web-ds-tools.components.common/textarea","bb-web-ds-tools.components.common/button","bb-web-ds-tools.components.common/pre-block","p__42147","map__42148","bb-web-ds-tools.components.malli/generation-panel","on-generate"],"sourcesContent":["(ns bb-web-ds-tools.components.malli\n  (:require [clojure.walk :as walk]\n            [malli.provider :as mp]\n            [malli.generator :as mg]\n            [malli.core :as m]\n            [malli.json-schema :as json-schema]\n            [clojure.string :as str]\n            #?(:cljs [cljs.pprint :as pprint]\n               :clj [clojure.pprint :as pprint])\n            #?(:cljs [cljs.reader :as reader]\n               :clj [clojure.edn :as reader])\n            #?(:clj [cheshire.core :as json])\n            #?(:cljs [bb-web-ds-tools.components.common :as c])))\n\n;; Utils\n\n(defn parse-int\n  \"Parses a string to an integer. Cross-platform.\n\n  Args:\n    s (string): The string to parse.\n\n  Returns:\n    integer: The parsed integer.\"\n  [s]\n  #?(:cljs (js/parseInt s)\n     :clj (Integer/parseInt s)))\n\n(defn read-edn\n  \"Reads EDN from a string. Cross-platform.\n\n  Args:\n    s (string): The EDN string.\n\n  Returns:\n    any: The parsed data.\"\n  [s]\n  (reader/read-string s))\n\n(defn parse-json\n  \"Parses a JSON string. Cross-platform.\n\n  Args:\n    s (string): The JSON string.\n\n  Returns:\n    any: The parsed data (keywordized keys in Clojure).\"\n  [s]\n  #?(:cljs (js->clj (js/JSON.parse s) :keywordize-keys true)\n     :clj (json/parse-string s true)))\n\n(defn generate-json\n  \"Generates a JSON string from data. Cross-platform.\n\n  Args:\n    data (any): The data to serialize.\n\n  Returns:\n    string: The JSON string.\"\n  [data]\n  #?(:cljs (js/JSON.stringify (clj->js data) nil 2)\n     :clj (json/generate-string data {:pretty true})))\n\n(defn pretty-print-str\n  \"Pretty prints data to a string. Cross-platform.\n\n  Args:\n    data (any): The data to print.\n\n  Returns:\n    string: The formatted string.\"\n  [data]\n  (with-out-str (pprint/pprint data)))\n\n;; Component Logic\n\n(defn detect-and-parse\n  \"Detects input format (EDN or JSON) and parses it.\n\n  Args:\n    text (string): The input text.\n\n  Returns:\n    any: The parsed data or nil.\"\n  [text]\n  (if (str/blank? text)\n    nil\n    (try\n      (read-edn text)\n      (catch #?(:cljs :default :clj Exception) _\n        (try\n          (parse-json text)\n          (catch #?(:cljs :default :clj Exception) _ nil))))))\n\n(defn parse-schema-and-generate\n  \"Parses a Malli schema from EDN string.\n\n  Args:\n    schema-text (string): The schema EDN string.\n\n  Returns:\n    map: {:success true :schema ...} or {:success false :error ...}.\"\n  [schema-text]\n  (try\n    (let [schema (read-edn schema-text)]\n      {:success true :schema schema})\n    (catch #?(:cljs :default :clj Exception) e\n      {:success false :error (str \"Invalid schema EDN: \" (ex-message e))})))\n\n(defn generate-data\n  \"Generates random data from a Malli schema.\n\n  Args:\n    schema (any): The Malli schema.\n    samples (int): Number of samples.\n    format (keyword): Output format (:edn or :json).\n\n  Returns:\n    map: {:success true :output string :data any}.\"\n  [schema samples format]\n  (if (and schema (pos? samples))\n    (let [data (if (> samples 1)\n                 (vec (repeatedly samples #(mg/generate schema)))\n                 (mg/generate schema))\n          output (case format\n                   :edn (pretty-print-str data)\n                   :json (generate-json data)\n                   (pr-str data))]\n      {:success true :output output :data data})\n    {:success false :error \"Invalid schema or samples.\"}))\n\n(defn- annotate-schema\n  \"Recursively builds a tree of {:type ... :data ...} to align data with schema.\"\n  [schema data]\n  (cond\n    ;; Map\n    (and (vector? schema) (= :map (first schema)))\n    (let [[type & tail] schema\n          [props entries] (if (map? (first tail))\n                            [(first tail) (rest tail)]\n                            [nil tail])\n          maps (if (map? data) [data] (filter map? data))]\n      {:type :map\n       :schema-type type\n       :props props\n       :children (mapv (fn [entry]\n                         (if (vector? entry)\n                           (let [has-props? (map? (second entry))\n                                 k (first entry)\n                                 [p v-schema] (if has-props?\n                                                [(second entry) (nth entry 2)]\n                                                [nil (second entry)])\n                                 vals (map #(get % k) maps)\n                                 child-node (annotate-schema v-schema vals)]\n                             {:type :entry :key k :props p :child child-node})\n                           {:type :entry-raw :original entry}))\n                       entries)})\n\n    ;; Collection\n    (and (vector? schema) (#{ :vector :sequential :set } (first schema)))\n    (let [[type child-schema] schema\n          child-data (if (every? coll? data) (mapcat identity data) data)]\n      {:type :collection\n       :collection-type type\n       :child (annotate-schema child-schema child-data)})\n\n    ;; Wrapper (Maybe)\n    (and (vector? schema) (= :maybe (first schema)))\n    (let [[type child-schema] schema\n          child-data (remove nil? data)]\n      {:type :wrapper\n       :wrapper-type type\n       :child (annotate-schema child-schema child-data)})\n\n    ;; Leaf\n    :else\n    {:type :leaf\n     :schema schema\n     :data data}))\n\n(defn- deannotate-schema\n  \"Reconstructs schema from annotated tree using postwalk.\"\n  [tree]\n  (walk/postwalk\n    (fn [node]\n      (if (map? node)\n        (case (:type node)\n          :map (into (if (:props node) [(:schema-type node) (:props node)] [(:schema-type node)])\n                     (:children node))\n          :entry (if (:props node)\n                   [(:key node) (:props node) (:child node)]\n                   [(:key node) (:child node)])\n          :entry-raw (:original node)\n          :collection [(:collection-type node) (:child node)]\n          :wrapper [(:wrapper-type node) (:child node)]\n          :leaf (:schema node)\n          node)\n        node))\n    tree))\n\n(defn- refine-schema-with-data\n  \"Refines schema by replacing string types with enums and adding min/max to numbers and dates.\"\n  [schema data max-values]\n  (let [annotated (annotate-schema schema data)\n        refined (walk/postwalk\n                  (fn [node]\n                    (if (and (map? node) (= :leaf (:type node)))\n                      (let [s (:schema node)\n                            d (:data node)\n                            s-type (if (vector? s) (first s) s)]\n                        (cond\n                          ;; Enum Inference\n                          (or (= s-type 'string?) (= s-type :string))\n                          (let [strings (filter string? d)\n                                distinct-vals (distinct strings)\n                                cnt (count distinct-vals)]\n                            (if (and (pos? cnt) (<= cnt max-values))\n                              (assoc node :schema (into [:enum] (sort distinct-vals)))\n                              node))\n\n                          ;; Min/Max Inference (Numbers)\n                          (#{:int :double :number 'int? 'double? 'number?} s-type)\n                          (let [nums (filter number? d)]\n                            (if (seq nums)\n                              (let [min-val (apply min nums)\n                                    max-val (apply max nums)\n                                    existing-props (if (and (vector? s) (map? (second s))) (second s) nil)\n                                    new-props (merge existing-props {:min min-val :max max-val})\n                                    new-schema (if (vector? s)\n                                                 (if (map? (second s))\n                                                   (assoc s 1 new-props)\n                                                   (into [(first s) new-props] (rest s)))\n                                                 [s new-props])]\n                                (assoc node :schema new-schema))\n                              node))\n\n                          ;; Min/Max Inference (Dates)\n                          (or (= s-type 'inst?) (= s-type :inst))\n                          (let [dates (filter inst? d)]\n                            (if (seq dates)\n                              (let [sorted (sort dates)\n                                    min-val (first sorted)\n                                    max-val (last sorted)\n                                    existing-props (if (and (vector? s) (map? (second s))) (second s) nil)\n                                    new-props (merge existing-props {:min min-val :max max-val})\n                                    new-schema (if (vector? s)\n                                                 (if (map? (second s))\n                                                   (assoc s 1 new-props)\n                                                   (into [(first s) new-props] (rest s)))\n                                                 [s new-props])]\n                                (assoc node :schema new-schema))\n                              node))\n\n                          :else node))\n                      node))\n                  annotated)]\n    (deannotate-schema refined)))\n\n(defn infer-schema\n  \"Infers a Malli schema from data.\n\n  Args:\n    input-data (coll): The input data sample.\n    max-enum-values (int, optional): Max values to infer enum. Default 10.\n\n  Returns:\n    map: {:success true :schema-str string} or error.\"\n  ([input-data] (infer-schema input-data 10))\n  ([input-data max-enum-values]\n   (if (and (coll? input-data) (seq input-data))\n     (let [schema (mp/provide input-data)\n           refined-schema (refine-schema-with-data schema input-data max-enum-values)]\n       {:success true\n        :schema-str (pretty-print-str refined-schema)})\n     {:success false\n      :error \"Invalid input data or empty sequence.\"})))\n\n(defn save-dataset-data\n  \"Parses generated data string back to data for saving.\n\n  Args:\n    generated-data (string): The data string.\n    format (keyword): The format.\n\n  Returns:\n    any: The parsed data or nil.\"\n  [generated-data format]\n   (case format\n      :edn (try (read-edn generated-data) (catch #?(:cljs :default :clj Exception) _ nil))\n      :json (try (parse-json generated-data) (catch #?(:cljs :default :clj Exception) _ nil))\n      nil))\n\n(defn validate-data\n  \"Validates data against a schema.\n\n  Args:\n    schema (any): The Malli schema.\n    data (any): The data to validate.\n\n  Returns:\n    map: {:success true :result string} or error.\"\n  [schema data]\n  (if (and schema data)\n    (if (m/validate schema data)\n      {:success true :result \"\u2705 Data is valid.\"}\n      {:success false :result (m/explain schema data)})\n    {:success false :error \"Invalid schema or data.\"}))\n\n(defn transform-to-json-schema\n  \"Transforms a Malli schema to JSON Schema.\n\n  Args:\n    schema (any): The Malli schema.\n\n  Returns:\n    map: {:success true :json-schema string} or error.\"\n  [schema]\n  (if schema\n    (try\n      {:success true :json-schema (generate-json (json-schema/transform schema))}\n      (catch #?(:cljs :default :clj Exception) e\n        {:success false :error (str \"Transformation failed: \" (ex-message e))}))\n    {:success false :error \"Invalid schema.\"}))\n\n;; Legacy UI Components (kept for stories compatibility)\n#?(:cljs\n   (do\n     (defn inference-panel\n       \"Renders the legacy inference panel.\n\n       Args:\n         props (map): {:values, :handle-change, :on-infer, :inferred-schema}.\n\n       Returns:\n         vector: A hiccup vector.\"\n       [{:keys [values handle-change on-infer inferred-schema]}]\n       [c/card {}\n        [:div\n         [:h3 {:class \"text-xl font-semibold text-white mb-4 flex items-center gap-2\"}\n          [:span \"\ud83e\udde9\"] \"Schema Inference\"]\n         [:div {:class \"grid grid-cols-1 lg:grid-cols-2 gap-6\"}\n          [:div\n           [c/label \"Input Data (EDN)\"]\n           [c/textarea {:value (get values \"inference-input\")\n                        :name \"inference-input\"\n                        :placeholder \"{:user/name \\\"Alice\\\" :user/age 30}\"\n                        :on-change handle-change\n                        :class \"h-64\"}]\n           [:div {:class \"mt-4\"}\n            [c/button {:on-click on-infer} \"Infer Schema\"]]]\n          [:div\n           [c/label \"Inferred Schema\"]\n           [c/pre-block {:content inferred-schema :class \"h-64\"}]]]]])\n\n     (defn generation-panel\n       \"Renders the legacy generation panel.\n\n       Args:\n         props (map): {:values, :handle-change, :on-generate, :generated-data}.\n\n       Returns:\n         vector: A hiccup vector.\"\n       [{:keys [values handle-change on-generate generated-data]}]\n       [c/card {}\n        [:div\n         [:h3 {:class \"text-xl font-semibold text-white mb-4 flex items-center gap-2\"}\n          [:span \"\ud83c\udfb2\"] \"Data Generation\"]\n         [:div {:class \"grid grid-cols-1 lg:grid-cols-2 gap-6\"}\n          [:div\n           [c/label \"Schema (EDN)\"]\n           [c/textarea {:value (get values \"schema-text\")\n                        :name \"schema-text\"\n                        :placeholder \"[:map [:x int?] [:y int?]]\"\n                        :on-change handle-change\n                        :class \"h-64\"}]\n           [:div {:class \"mt-4\"}\n            [c/button {:on-click on-generate} \"Generate Data\"]]]\n          [:div\n           [c/label \"Generated Data\"]\n           [c/pre-block {:content generated-data :class \"h-64\"}]]]]])))\n"],"x_google_ignoreList":[0]}