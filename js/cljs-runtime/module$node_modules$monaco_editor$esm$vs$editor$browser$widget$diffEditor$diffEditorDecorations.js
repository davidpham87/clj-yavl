shadow$provide.module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorDecorations = function(require, module, exports) {
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, DiffEditorDecorations:{enumerable:!0, get:function() {
    return DiffEditorDecorations;
  }}});
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$browser$dom"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_ui_SLASH_iconLabel_SLASH_iconLabels_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$browser$ui$iconLabel$iconLabels"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_codicons_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$base$common$codicons"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$lifecycle"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$observable"), require$_DOT__SLASH_decorations_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$decorations"), require$_DOT__SLASH_movedBlocksLines_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$movedBlocksLines"), require$_DOT__SLASH_utils_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$utils"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_lineRange_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$core$lineRange"), 
  require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_range_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$core$range"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_model_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$model"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_nls_DOT_js = require("module$node_modules$monaco_editor$esm$vs$nls");
  class DiffEditorDecorations extends require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.Disposable {
    constructor(_editors, _diffModel, _options, widget) {
      super();
      this._editors = _editors;
      this._diffModel = _diffModel;
      this._options = _options;
      this._decorations = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(this, reader => {
        var _a;
        const diff = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader);
        if (!diff) {
          return null;
        }
        const movedTextToCompare = this._diffModel.read(reader).movedTextToCompare.read(reader), renderIndicators = this._options.renderIndicators.read(reader), showEmptyDecorations = this._options.showEmptyDecorations.read(reader);
        _a = [];
        const modifiedDecorations = [];
        if (!movedTextToCompare) {
          for (var m$jscomp$0 of diff.mappings) {
            if (m$jscomp$0.lineRangeMapping.original.isEmpty || _a.push({range:m$jscomp$0.lineRangeMapping.original.toInclusiveRange(), options:renderIndicators ? require$_DOT__SLASH_decorations_DOT_js.diffLineDeleteDecorationBackgroundWithIndicator : require$_DOT__SLASH_decorations_DOT_js.diffLineDeleteDecorationBackground}), m$jscomp$0.lineRangeMapping.modified.isEmpty || modifiedDecorations.push({range:m$jscomp$0.lineRangeMapping.modified.toInclusiveRange(), options:renderIndicators ? require$_DOT__SLASH_decorations_DOT_js.diffLineAddDecorationBackgroundWithIndicator : 
            require$_DOT__SLASH_decorations_DOT_js.diffLineAddDecorationBackground}), m$jscomp$0.lineRangeMapping.modified.isEmpty || m$jscomp$0.lineRangeMapping.original.isEmpty) {
              m$jscomp$0.lineRangeMapping.original.isEmpty || _a.push({range:m$jscomp$0.lineRangeMapping.original.toInclusiveRange(), options:require$_DOT__SLASH_decorations_DOT_js.diffWholeLineDeleteDecoration}), m$jscomp$0.lineRangeMapping.modified.isEmpty || modifiedDecorations.push({range:m$jscomp$0.lineRangeMapping.modified.toInclusiveRange(), options:require$_DOT__SLASH_decorations_DOT_js.diffWholeLineAddDecoration});
            } else {
              for (const i of m$jscomp$0.lineRangeMapping.innerChanges || []) {
                m$jscomp$0.lineRangeMapping.original.contains(i.originalRange.startLineNumber) && _a.push({range:i.originalRange, options:i.originalRange.isEmpty() && showEmptyDecorations ? require$_DOT__SLASH_decorations_DOT_js.diffDeleteDecorationEmpty : require$_DOT__SLASH_decorations_DOT_js.diffDeleteDecoration}), m$jscomp$0.lineRangeMapping.modified.contains(i.modifiedRange.startLineNumber) && modifiedDecorations.push({range:i.modifiedRange, options:i.modifiedRange.isEmpty() && showEmptyDecorations ? 
                require$_DOT__SLASH_decorations_DOT_js.diffAddDecorationEmpty : require$_DOT__SLASH_decorations_DOT_js.diffAddDecoration});
              }
            }
          }
        }
        if (movedTextToCompare) {
          for (const m of movedTextToCompare.changes) {
            (m$jscomp$0 = m.original.toInclusiveRange()) && _a.push({range:m$jscomp$0, options:renderIndicators ? require$_DOT__SLASH_decorations_DOT_js.diffLineDeleteDecorationBackgroundWithIndicator : require$_DOT__SLASH_decorations_DOT_js.diffLineDeleteDecorationBackground});
            (m$jscomp$0 = m.modified.toInclusiveRange()) && modifiedDecorations.push({range:m$jscomp$0, options:renderIndicators ? require$_DOT__SLASH_decorations_DOT_js.diffLineAddDecorationBackgroundWithIndicator : require$_DOT__SLASH_decorations_DOT_js.diffLineAddDecorationBackground});
            for (const i of m.innerChanges || []) {
              _a.push({range:i.originalRange, options:require$_DOT__SLASH_decorations_DOT_js.diffDeleteDecoration}), modifiedDecorations.push({range:i.modifiedRange, options:require$_DOT__SLASH_decorations_DOT_js.diffAddDecoration});
            }
          }
        }
        reader = this._diffModel.read(reader).activeMovedText.read(reader);
        for (const m of diff.movedTexts) {
          _a.push({range:m.lineRangeMapping.original.toInclusiveRange(), options:{description:"moved", blockClassName:"movedOriginal" + (m === reader ? " currentMove" : ""), blockPadding:[require$_DOT__SLASH_movedBlocksLines_DOT_js.MovedBlocksLinesPart.movedCodeBlockPadding, 0, require$_DOT__SLASH_movedBlocksLines_DOT_js.MovedBlocksLinesPart.movedCodeBlockPadding, require$_DOT__SLASH_movedBlocksLines_DOT_js.MovedBlocksLinesPart.movedCodeBlockPadding]}}), modifiedDecorations.push({range:m.lineRangeMapping.modified.toInclusiveRange(), 
          options:{description:"moved", blockClassName:"movedModified" + (m === reader ? " currentMove" : ""), blockPadding:[4, 0, 4, 4]}});
        }
        return {originalDecorations:_a, modifiedDecorations};
      });
      this._register(new RevertButtonsFeature(_editors, _diffModel, _options, widget));
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyObservableDecorations)(this._editors.original, this._decorations.map(d => (d === null || d === void 0 ? void 0 : d.originalDecorations) || [])));
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyObservableDecorations)(this._editors.modified, this._decorations.map(d => (d === null || d === void 0 ? void 0 : d.modifiedDecorations) || [])));
    }
  }
  class RevertButtonsFeature extends require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.Disposable {
    constructor(_editors, _diffModel, _options, _widget) {
      super();
      this._editors = _editors;
      this._diffModel = _diffModel;
      this._options = _options;
      this._widget = _widget;
      const emptyArr = [], selectedDiffs = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(this, reader => {
        var model = this._diffModel.read(reader);
        model = model === null || model === void 0 ? void 0 : model.diff.read(reader);
        if (!model) {
          return emptyArr;
        }
        const selections = this._editors.modifiedSelections.read(reader);
        if (selections.every(s => s.isEmpty())) {
          return emptyArr;
        }
        const lineRanges = new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_lineRange_DOT_js.LineRangeSet(selections.map(s => require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_lineRange_DOT_js.LineRange.fromRangeInclusive(s)));
        reader = model.mappings.filter(m => m.lineRangeMapping.innerChanges && lineRanges.intersects(m.lineRangeMapping.modified)).map(mapping => ({mapping, rangeMappings:mapping.lineRangeMapping.innerChanges.filter(c => selections.some(s => require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_range_DOT_js.Range.areIntersecting(c.modifiedRange, s)))}));
        return reader.length === 0 || reader.every(r => r.rangeMappings.length === 0) ? emptyArr : reader;
      });
      this._register((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.autorunWithStore)((reader, store) => {
        var model = this._diffModel.read(reader), diff = model === null || model === void 0 ? void 0 : model.diff.read(reader);
        if (model && diff && !this._diffModel.read(reader).movedTextToCompare.read(reader) && this._options.shouldRenderRevertArrows.read(reader)) {
          var glyphWidgetsModified = [], selectedDiffs_ = selectedDiffs.read(reader);
          model = new Set(selectedDiffs_.map(d => d.mapping));
          selectedDiffs_.length > 0 && (reader = this._editors.modifiedSelections.read(reader), reader = new RevertButton(reader[reader.length - 1].positionLineNumber, this._widget, selectedDiffs_.flatMap(d => d.rangeMappings), !0), this._editors.modified.addGlyphMarginWidget(reader), glyphWidgetsModified.push(reader));
          for (const m of diff.mappings) {
            model.has(m) || m.lineRangeMapping.modified.isEmpty || !m.lineRangeMapping.innerChanges || (diff = new RevertButton(m.lineRangeMapping.modified.startLineNumber, this._widget, m.lineRangeMapping.innerChanges, !1), this._editors.modified.addGlyphMarginWidget(diff), glyphWidgetsModified.push(diff));
          }
          store.add((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => {
            for (const w of glyphWidgetsModified) {
              this._editors.modified.removeGlyphMarginWidget(w);
            }
          }));
        }
      }));
    }
  }
  class RevertButton {
    getId() {
      return this._id;
    }
    constructor(_lineNumber, _widget, _diffs, _selection) {
      this._lineNumber = _lineNumber;
      this._widget = _widget;
      this._diffs = _diffs;
      this._selection = _selection;
      this._id = `revertButton${RevertButton.counter++}`;
      this._domNode = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.h)("div.revertButton", {title:this._selection ? (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_nls_DOT_js.localize)("revertSelectedChanges", "Revert Selected Changes") : (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_nls_DOT_js.localize)("revertChange", "Revert Change")}, [(0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_ui_SLASH_iconLabel_SLASH_iconLabels_DOT_js.renderIcon)(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_codicons_DOT_js.Codicon.arrowRight)]).root;
      this._domNode.onmousedown = e => {
        e.button !== 2 && (e.stopPropagation(), e.preventDefault());
      };
      this._domNode.onmouseup = e => {
        e.stopPropagation();
        e.preventDefault();
      };
      this._domNode.onclick = e => {
        this._widget.revertRangeMappings(this._diffs);
        e.stopPropagation();
        e.preventDefault();
      };
    }
    getDomNode() {
      return this._domNode;
    }
    getPosition() {
      return {lane:require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_model_DOT_js.GlyphMarginLane.Right, range:{startColumn:1, startLineNumber:this._lineNumber, endColumn:1, endLineNumber:this._lineNumber}, zIndex:10001};
    }
  }
  RevertButton.counter = 0;
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorDecorations.js.map
