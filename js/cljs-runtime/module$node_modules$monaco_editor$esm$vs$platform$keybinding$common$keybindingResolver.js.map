{
"version":3,
"file":"module$node_modules$monaco_editor$esm$vs$platform$keybinding$common$keybindingResolver.js",
"lineCount":193,
"mappings":"AAAAA,cAAA,CAAA,sFAAA,GAA2G,QAAQ,CAACC,OAAD,EAASC,MAAT,EAAgBC,OAAhB,CAAyB;AAsP5IC,UAASA,qBAAoB,CAACC,IAAD,CAAO;AAClC,WAAKA,IAAL,GAGQ,GAAEA,IAAKC,CAAAA,SAAL,EAAF,EAHR,GACU,mBADV;AADkC;AAMpCC,UAASA,uBAAsB,CAACC,EAAD,CAAK;AAClC,WAAOA,EAAGC,CAAAA,WAAH,GAAiBD,EAAGE,CAAAA,kBAAH,GAAyB,sBAAqBF,EAAGC,CAAAA,WAAxB,EAAzB,GAAkE,kBAAiBD,EAAGC,CAAAA,WAApB,EAAnF,GAAuHD,EAAGG,CAAAA,SAAH,GAAgB,UAAhB,GAA6B,MAA3J;AADkC;AA3PpCC,QAAOC,CAAAA,gBAAP,CAAwBV,OAAxB,EAAiC,CAACW,WAAW,CAACC,WAAW,CAAA,CAAZ,EAAkBC,MAAM,CAAA,CAAxB,CAAZ,EAA2CC,mBAAmB,CAACF,WAAW,CAAA,CAAZ,EAAkBG,IAAIA,QAAQ,EAAG;AAC9H,WAAOD,kBAAP;AAD8H,GAAjC,CAA9D,EAE7BE,aAAa,CAACJ,WAAW,CAAA,CAAZ,EAAkBG,IAAIA,QAAQ,EAAG;AAChD,WAAOC,YAAP;AADgD,GAAjC,CAFgB,CAAjC,CAAA;AAKA,MAAIC,4FAA4FnB,OAAA,CAAQ,gFAAR,CAAhG;AACA,QAAMkB,eAAe,CAACE,KAAK,CAAN,CAArB,EACMC,mBAAmB,CAACD,KAAK,CAAN,CADzB;AAKA,OAAMJ,mBAAN;AACEM,eAAW,CAACC,kBAAD,EAAqBC,SAArB,EAAgCC,GAAhC,CAAqC;AAC9C,UAAIC,EAAJ;AACA,UAAKC,CAAAA,IAAL,GAAYF,GAAZ;AACA,UAAKG,CAAAA,mBAAL,GAA2BL,kBAA3B;AACA,UAAKM,CAAAA,qBAAL,GAA6B,IAAIC,GAAJ,EAA7B;AACA,WAAK,MAAMC,iBAAX,IAAgCR,kBAAhC;AAEE,SADMS,GACN,GADgBD,iBAAkBC,CAAAA,OAClC,KAAeA,GAAQC,CAAAA,MAAR,CAAe,CAAf,CAAf,KAAqC,GAArC,IACE,IAAKJ,CAAAA,qBAAsBK,CAAAA,GAA3B,CAA+BF,GAA/B,EAAwC,CAAA,CAAxC,CADF;AAFF;AAMA,UAAKG,CAAAA,IAAL,GAAY,IAAIL,GAAJ,EAAZ;AACA,UAAKM,CAAAA,UAAL,GAAkB,IAAIN,GAAJ,EAAlB;AACA,UAAKO,CAAAA,YAAL,GAAoBrB,kBAAmBsB,CAAAA,cAAnB,CAAkC,EAAGC,CAAAA,MAAH,CAAUhB,kBAAV,CAA8BgB,CAAAA,MAA9B,CAAqCf,SAArC,CAAlC,CAApB;AACA,WAAK,IAAIgB,IAAI,CAAR,EAAWC,MAAM,IAAKJ,CAAAA,YAAaK,CAAAA,MAAxC,EAAgDF,CAAhD,GAAoDC,GAApD,EAAyDD,CAAA,EAAzD;AACQG,0BACN,GADU,IAAKN,CAAAA,YAAL,CAAkBG,CAAlB,CACV,EAAIG,kBAAEC,CAAAA,MAAOF,CAAAA,MAAb,KAAwB,CAAxB,MAGMtC,SAHN,GAGa,CAACsB,EAAD,GAAMiB,kBAAEvC,CAAAA,IAAR,MAAkB,IAAlB,IAA0BsB,EAA1B,KAAiC,IAAK,EAAtC,GAA0C,IAAK,EAA/C,GAAmDA,EAAGmB,CAAAA,mBAAH,EAHhE,KAIYzC,SAAK0C,CAAAA,IAJjB,KAI0B,CAJ1B,IAOA,IAAKC,CAAAA,YAAL,CAAkBJ,kBAAEC,CAAAA,MAAF,CAAS,CAAT,CAAlB,EAA+BD,kBAA/B,CAPA,CAAA;AAFF;AAd8C;AA0BzCK,gCAAqB,CAACC,SAAD,EAAYC,QAAZ,EAAsB9C,IAAtB,CAA4B;AACtD,UAAI8C,QAAJ;AACE,aAAK,IAAIV,IAAI,CAAb,EAAgBA,CAAhB,GAAoBU,QAASR,CAAAA,MAA7B,EAAqCF,CAAA,EAArC;AACE,cAAIU,QAAA,CAASV,CAAT,CAAJ,KAAoBS,SAAUL,CAAAA,MAAV,CAAiBJ,CAAjB,CAApB;AACE,mBAAO,CAAA,CAAP;AADF;AADF;AADF;AAOA,aAAIpC,CAAAA,IAAJ,IAAYA,IAAK0C,CAAAA,IAAjB,KAA0B,CAA1B,IACOG,SAAU7C,CAAAA,IADjB,IAIO,GAAGe,yFAA0FgC,CAAAA,2CAA7F,EAA0I/C,IAA1I,EAAgJ6C,SAAU7C,CAAAA,IAA1J,CAJP,GAQO,CAAA,CARP,GAKW,CAAA,CALX;AARsD;AAkBjDkC,yBAAc,CAACc,KAAD,CAAQ;AAC3B,YAAMC,WAAW,IAAIvB,GAAJ,EAAjB;AACA,WAAK,IAAIU,IAAI,CAAR,EAAWC,MAAMW,KAAMV,CAAAA,MAA5B,EAAoCF,CAApC,GAAwCC,GAAxC,EAA6CD,CAAA,EAA7C,CAAkD;AAChD,YAAMc,OAAOF,KAAA,CAAMZ,CAAN,CAAb;AACA,YAAIc,IAAKtB,CAAAA,OAAT,IAAoBsB,IAAKtB,CAAAA,OAAQC,CAAAA,MAAb,CAAoB,CAApB,CAApB,KAA+C,GAA/C,CAAoD;AAClD,cAAMD,UAAUsB,IAAKtB,CAAAA,OAAQuB,CAAAA,SAAb,CAAuB,CAAvB,CAAhB;AACKF,kBAASG,CAAAA,GAAT,CAAaxB,OAAb,CAAL,GAGEqB,QAASpC,CAAAA,GAAT,CAAae,OAAb,CAAsByB,CAAAA,IAAtB,CAA2BH,IAA3B,CAHF,GACED,QAASnB,CAAAA,GAAT,CAAaF,OAAb,EAAsB,CAACsB,IAAD,CAAtB,CADF;AAFkD;AAFJ;AAWlD,UAAID,QAASK,CAAAA,IAAb,KAAsB,CAAtB;AACE,eAAON,KAAP;AADF;AAGMO,UAAAA,GAAS,EAATA;AACN,WAAK,IAAInB,IAAI,CAAR,EAAWC,MAAMW,KAAMV,CAAAA,MAA5B,EAAoCF,CAApC,GAAwCC,GAAxC,EAA6CD,CAAA,EAA7C,CAAkD;AAC1Cc,eAAAA,GAAOF,KAAA,CAAMZ,CAAN,CAAPc;AACN,YAAI,CAACA,OAAKtB,CAAAA,OAAV,IAAqBsB,OAAKtB,CAAAA,OAAQU,CAAAA,MAAlC,KAA6C,CAA7C,CAAgD;AAC9CiB,cAAOF,CAAAA,IAAP,CAAYH,OAAZ,CAAA;AACA;AAF8C;AAIhD,YAAIA,OAAKtB,CAAAA,OAAQC,CAAAA,MAAb,CAAoB,CAApB,CAAJ,KAA+B,GAA/B;AACE;AADF;AAGA,cAAM2B,kBAAkBP,QAASpC,CAAAA,GAAT,CAAaqC,OAAKtB,CAAAA,OAAlB,CAAxB;AACA,YAAI,CAAC4B,eAAL,IAAwB,CAACN,OAAK5C,CAAAA,SAA9B,CAAyC;AACvCiD,cAAOF,CAAAA,IAAP,CAAYH,OAAZ,CAAA;AACA;AAFuC;AAIzC,YAAIO,YAAY,CAAA,CAAhB;AACA,aAAK,MAAMC,cAAX,IAA6BF,eAA7B;AAEE,cAAI,IAAKZ,CAAAA,qBAAL,CAA2BM,OAA3B,EAAiCQ,cAAelB,CAAAA,MAAhD,EADSkB,cAAe1D,CAAAA,IACxB,CAAJ,CAAmE;AACjEyD,qBAAA,GAAY,CAAA,CAAZ;AACA;AAFiE;AAFrE;AAOKA,iBAAL,IACEF,IAAOF,CAAAA,IAAP,CAAYH,OAAZ,CADF;AAtBgD;AA2BlD,aAAOK,IAAP;AA5C2B;AA8C7BZ,gBAAY,CAACG,QAAD,EAAWa,IAAX,CAAiB;AAC3B,YAAMC,YAAY,IAAK7B,CAAAA,IAAKlB,CAAAA,GAAV,CAAciC,QAAd,CAAlB;AACA,UAAI,MAAOc,UAAX,KAAyB,WAAzB;AACE,YAAK7B,CAAAA,IAAKD,CAAAA,GAAV,CAAcgB,QAAd,EAAwB,CAACa,IAAD,CAAxB,CAAA;AADF,YAAA;AAKA,aAASvB,QAAT,GAAawB,SAAUtB,CAAAA,MAAvB,GAAgC,CAAhC,EAAmCF,QAAnC,IAAwC,CAAxC,EAA2CA,QAAA,EAA3C,CAAgD;AAC9C,gBAAMyB,WAAWD,SAAA,CAAUxB,QAAV,CAAjB;AACA,cAAIyB,QAASjC,CAAAA,OAAb,KAAyB+B,IAAK/B,CAAAA,OAA9B;AACE;AADF;AAGA,cAAIkC,oBAAoB,CAAA,CAAxB;AACA,eAAK,IAAI1B,IAAI,CAAb,EAAgBA,CAAhB,GAAoByB,QAASrB,CAAAA,MAAOF,CAAAA,MAApC,IAA8CF,CAA9C,GAAkDuB,IAAKnB,CAAAA,MAAOF,CAAAA,MAA9D,EAAsEF,CAAA,EAAtE;AACE,gBAAIyB,QAASrB,CAAAA,MAAT,CAAgBJ,CAAhB,CAAJ,KAA2BuB,IAAKnB,CAAAA,MAAL,CAAYJ,CAAZ,CAA3B,CAA2C;AACzC0B,+BAAA,GAAoB,CAAA,CAApB;AACA;AAFyC;AAD7C;AAMKA,2BAAL,IAGIlD,kBAAmBmD,CAAAA,sBAAnB,CAA0CF,QAAS7D,CAAAA,IAAnD,EAAyD2D,IAAK3D,CAAAA,IAA9D,CAHJ,IAIE,IAAKgE,CAAAA,oBAAL,CAA0BH,QAA1B,CAJF;AAZ8C;AAmBhDD,iBAAUP,CAAAA,IAAV,CAAeM,IAAf,CAAA;AAxBA;AAEE,UAAKM,CAAAA,eAAL,CAAqBN,IAArB,CAAA;AAJyB;AA6B7BM,mBAAe,CAACN,IAAD,CAAO;AACpB,UAAKA,IAAK/B,CAAAA,OAAV,CAAA;AAGA,YAAIsC,MAAM,IAAKlC,CAAAA,UAAWnB,CAAAA,GAAhB,CAAoB8C,IAAK/B,CAAAA,OAAzB,CAAV;AACI,cAAOsC,IAAX,KAAmB,WAAnB,IACEA,GACA,GADM,CAACP,IAAD,CACN,EAAA,IAAK3B,CAAAA,UAAWF,CAAAA,GAAhB,CAAoB6B,IAAK/B,CAAAA,OAAzB,EAAkCsC,GAAlC,CAFF,IAIEA,GAAIb,CAAAA,IAAJ,CAASM,IAAT,CAJF;AAJA;AADoB;AAYtBK,wBAAoB,CAACL,IAAD,CAAO;AACzB,UAAKA,IAAK/B,CAAAA,OAAV,CAAA;AAGA,YAAMsC,MAAM,IAAKlC,CAAAA,UAAWnB,CAAAA,GAAhB,CAAoB8C,IAAK/B,CAAAA,OAAzB,CAAZ;AACA,YAAI,MAAOsC,IAAX,KAAmB,WAAnB;AAGA,eAAK,IAAI9B,IAAI,CAAR,EAAWC,MAAM6B,GAAI5B,CAAAA,MAA1B,EAAkCF,CAAlC,GAAsCC,GAAtC,EAA2CD,CAAA,EAA3C;AACE,gBAAI8B,GAAA,CAAI9B,CAAJ,CAAJ,KAAeuB,IAAf,CAAqB;AACnBO,iBAAIC,CAAAA,MAAJ,CAAW/B,CAAX,EAAc,CAAd,CAAA;AACA;AAFmB;AADvB;AAHA;AAJA;AADyB;AAepB2B,iCAAsB,CAACK,CAAD,EAAIC,CAAJ,CAAO;AAClC,aAAKA,CAAL,IAAUA,CAAE3B,CAAAA,IAAZ,KAAqB,CAArB,GAGK0B,CAAL,IAAUA,CAAE1B,CAAAA,IAAZ,KAAqB,CAArB,GAGO,GAAG3B,yFAA0FuD,CAAAA,OAA7F,EAAsGF,CAAtG,EAAyGC,CAAzG,CAHP,GACS,CAAA,CAJT,GACS,CAAA,CADT;AADkC;AASpCE,kBAAc,EAAG;AACf,aAAO,IAAKtC,CAAAA,YAAZ;AADe;AAGjBuC,2BAAuB,CAACC,SAAD,EAAYC,OAAZ,CAAqB;AACpCC,eAAAA,GAAQ,IAAK3C,CAAAA,UAAWnB,CAAAA,GAAhB,CAAoB4D,SAApB,CAARE;AACN,UAAI,MAAOA,UAAX,KAAqB,WAArB,IAAoCA,SAAMrC,CAAAA,MAA1C,KAAqD,CAArD;AACE,eAAO,IAAP;AADF;AAGA,UAAIqC,SAAMrC,CAAAA,MAAV,KAAqB,CAArB;AACE,eAAOqC,SAAA,CAAM,CAAN,CAAP;AADF;AAGA,WAAK,IAAIvC,IAAIuC,SAAMrC,CAAAA,MAAVF,GAAmB,CAA5B,EAA+BA,CAA/B,IAAoC,CAApC,EAAuCA,CAAA,EAAvC,CAA4C;AAC1C,cAAMuB,OAAOgB,SAAA,CAAMvC,CAAN,CAAb;AACA,YAAIsC,OAAQE,CAAAA,mBAAR,CAA4BjB,IAAK3D,CAAAA,IAAjC,CAAJ;AACE,iBAAO2D,IAAP;AADF;AAF0C;AAM5C,aAAOgB,SAAA,CAAMA,SAAMrC,CAAAA,MAAZ,GAAqB,CAArB,CAAP;AAd0C;AAgB5CuC,WAAO,CAACH,OAAD,EAAUI,aAAV,EAAyBhC,QAAzB,CAAmC;AAClCiC,mBAAAA,GAAgB,CAAC,GAAGD,aAAJ,EAAmBhC,QAAnB,CAAhBiC;AACN,UAAKxD,CAAAA,IAAL,CAAW,eAAcwD,aAAd,EAAX,CAAA;AACA,YAAMC,eAAe,IAAKjD,CAAAA,IAAKlB,CAAAA,GAAV,CAAckE,aAAA,CAAc,CAAd,CAAd,CAArB;AACA,UAAIC,YAAJ,KAAqBC,IAAAA,EAArB;AAEE,eADA,IAAK1D,CAAAA,IAAL,CAAW,2BAAX,CACOT,EAAAA,YAAP;AAFF;AAKA,UAAIiE,aAAczC,CAAAA,MAAlB,GAA2B,CAA3B;AACE4C,gBAAA,GAAYF,YAAZ;AADF,YAEO;AACLE,gBAAA,GAAY,EAAZ;AACA,aAAK,IAAI9C,IAAI,CAAR,EAAWC,MAAM2C,YAAa1C,CAAAA,MAAnC,EAA2CF,CAA3C,GAA+CC,GAA/C,EAAoDD,CAAA,EAApD,CAAyD;AACvD,gBAAM+C,YAAYH,YAAA,CAAa5C,CAAb,CAAlB;AACA,cAAI2C,aAAczC,CAAAA,MAAlB,GAA2B6C,SAAU3C,CAAAA,MAAOF,CAAAA,MAA5C;AACE;AADF;AAGA,cAAI8C,gBAAgB,CAAA,CAApB;AACA,eAAK,IAAIhD,IAAI,CAAb,EAAgBA,CAAhB,GAAoB2C,aAAczC,CAAAA,MAAlC,EAA0CF,CAAA,EAA1C;AACE,gBAAI+C,SAAU3C,CAAAA,MAAV,CAAiBJ,CAAjB,CAAJ,KAA4B2C,aAAA,CAAc3C,CAAd,CAA5B,CAA8C;AAC5CgD,2BAAA,GAAgB,CAAA,CAAhB;AACA;AAF4C;AADhD;AAMIA,uBAAJ,IACEF,QAAU7B,CAAAA,IAAV,CAAe8B,SAAf,CADF;AAZuD;AAFpD;AAmBD5B,aAAAA,GAAS,IAAK8B,CAAAA,YAAL,CAAkBX,OAAlB,EAA2BQ,QAA3B,CAAT3B;AACN,UAAI,CAACA,OAAL;AAEE,eADA,IAAKhC,CAAAA,IAAL,CAAW,WAAU2D,QAAU5C,CAAAA,MAApB,2DAAX,CACOxB,EAAAA,YAAP;AAFF;AAIA,UAAIiE,aAAczC,CAAAA,MAAlB,GAA2BiB,OAAOf,CAAAA,MAAOF,CAAAA,MAAzC;AAEE,eADA,IAAKf,CAAAA,IAAL,CAAW,WAAU2D,QAAU5C,CAAAA,MAApB,iCAA2DiB,OAAOf,CAAAA,MAAOF,CAAAA,MAAzE,GAAkFyC,aAAczC,CAAAA,MAAhG,yBAA+HvC,oBAAA,CAAqBwD,OAAOvD,CAAAA,IAA5B,CAA/H,aAA6KE,sBAAA,CAAuBqD,OAAvB,CAA7K,GAAX,CACOtC,EAAAA,gBAAP;AAFF;AAIA,UAAKM,CAAAA,IAAL,CAAW,WAAU2D,QAAU5C,CAAAA,MAApB,gCAA0DiB,OAAO3B,CAAAA,OAAjE,WAAmF7B,oBAAA,CAAqBwD,OAAOvD,CAAAA,IAA5B,CAAnF,aAAiIE,sBAAA,CAAuBqD,OAAvB,CAAjI,GAAX,CAAA;AACA,aAzNK,CAACvC,KAAK,CAAN,EAASyD,UAyNClB,OAAO3B,CAAAA,OAzNjB,EAAoB0D,YAyNM/B,OAAO+B,CAAAA,WAzNjC,EAAiCC,SAyNahC,OAAOiC,CAAAA,MAzNrD,CAyNL;AAxCwC;AA0C1CH,gBAAY,CAACX,OAAD,EAAUe,OAAV,CAAmB;AAC7B,WAAK,IAAIrD,IAAIqD,OAAQnD,CAAAA,MAAZF,GAAqB,CAA9B,EAAiCA,CAAjC,IAAsC,CAAtC,EAAyCA,CAAA,EAAzC,CAA8C;AAC5C,cAAMG,IAAIkD,OAAA,CAAQrD,CAAR,CAAV;AACA,YAAKxB,kBAAmB8E,CAAAA,oBAAnB,CAAwChB,OAAxC,EAAiDnC,CAAEvC,CAAAA,IAAnD,CAAL;AAGA,iBAAOuC,CAAP;AAHA;AAF4C;AAO9C,aAAO,IAAP;AAR6B;AAUxBmD,+BAAoB,CAAChB,OAAD,EAAU1B,KAAV,CAAiB;AAC1C,aAAKA,KAAL,GAGOA,KAAM2C,CAAAA,QAAN,CAAejB,OAAf,CAHP,GACS,CAAA,CADT;AAD0C;AAnO9C;AAZ4I,CAA5I;;",
"sources":["node_modules/monaco-editor/esm/vs/platform/keybinding/common/keybindingResolver.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$monaco_editor$esm$vs$platform$keybinding$common$keybindingResolver\"] = function(require,module,exports) {\nObject.defineProperties(exports, {__esModule:{enumerable:true, value:true}, KeybindingResolver:{enumerable:true, get:function() {\n  return KeybindingResolver;\n}}, NoMatchingKb:{enumerable:true, get:function() {\n  return NoMatchingKb;\n}}});\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js = require(\"../../contextkey/common/contextkey.js\");\nconst NoMatchingKb = {kind:0};\nconst MoreChordsNeeded = {kind:1};\nfunction KbFound(commandId, commandArgs, isBubble) {\n  return {kind:2, commandId, commandArgs, isBubble};\n}\nclass KeybindingResolver {\n  constructor(defaultKeybindings, overrides, log) {\n    var _a;\n    this._log = log;\n    this._defaultKeybindings = defaultKeybindings;\n    this._defaultBoundCommands = new Map();\n    for (const defaultKeybinding of defaultKeybindings) {\n      const command = defaultKeybinding.command;\n      if (command && command.charAt(0) !== \"-\") {\n        this._defaultBoundCommands.set(command, true);\n      }\n    }\n    this._map = new Map();\n    this._lookupMap = new Map();\n    this._keybindings = KeybindingResolver.handleRemovals([].concat(defaultKeybindings).concat(overrides));\n    for (let i = 0, len = this._keybindings.length; i < len; i++) {\n      const k = this._keybindings[i];\n      if (k.chords.length === 0) {\n        continue;\n      }\n      const when = (_a = k.when) === null || _a === void 0 ? void 0 : _a.substituteConstants();\n      if (when && when.type === 0) {\n        continue;\n      }\n      this._addKeyPress(k.chords[0], k);\n    }\n  }\n  static _isTargetedForRemoval(defaultKb, keypress, when) {\n    if (keypress) {\n      for (let i = 0; i < keypress.length; i++) {\n        if (keypress[i] !== defaultKb.chords[i]) {\n          return false;\n        }\n      }\n    }\n    if (when && when.type !== 1) {\n      if (!defaultKb.when) {\n        return false;\n      }\n      if (!(0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js.expressionsAreEqualWithConstantSubstitution)(when, defaultKb.when)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  static handleRemovals(rules) {\n    const removals = new Map();\n    for (let i = 0, len = rules.length; i < len; i++) {\n      const rule = rules[i];\n      if (rule.command && rule.command.charAt(0) === \"-\") {\n        const command = rule.command.substring(1);\n        if (!removals.has(command)) {\n          removals.set(command, [rule]);\n        } else {\n          removals.get(command).push(rule);\n        }\n      }\n    }\n    if (removals.size === 0) {\n      return rules;\n    }\n    const result = [];\n    for (let i = 0, len = rules.length; i < len; i++) {\n      const rule = rules[i];\n      if (!rule.command || rule.command.length === 0) {\n        result.push(rule);\n        continue;\n      }\n      if (rule.command.charAt(0) === \"-\") {\n        continue;\n      }\n      const commandRemovals = removals.get(rule.command);\n      if (!commandRemovals || !rule.isDefault) {\n        result.push(rule);\n        continue;\n      }\n      let isRemoved = false;\n      for (const commandRemoval of commandRemovals) {\n        const when = commandRemoval.when;\n        if (this._isTargetedForRemoval(rule, commandRemoval.chords, when)) {\n          isRemoved = true;\n          break;\n        }\n      }\n      if (!isRemoved) {\n        result.push(rule);\n        continue;\n      }\n    }\n    return result;\n  }\n  _addKeyPress(keypress, item) {\n    const conflicts = this._map.get(keypress);\n    if (typeof conflicts === \"undefined\") {\n      this._map.set(keypress, [item]);\n      this._addToLookupMap(item);\n      return;\n    }\n    for (let i = conflicts.length - 1; i >= 0; i--) {\n      const conflict = conflicts[i];\n      if (conflict.command === item.command) {\n        continue;\n      }\n      let isShorterKbPrefix = true;\n      for (let i = 1; i < conflict.chords.length && i < item.chords.length; i++) {\n        if (conflict.chords[i] !== item.chords[i]) {\n          isShorterKbPrefix = false;\n          break;\n        }\n      }\n      if (!isShorterKbPrefix) {\n        continue;\n      }\n      if (KeybindingResolver.whenIsEntirelyIncluded(conflict.when, item.when)) {\n        this._removeFromLookupMap(conflict);\n      }\n    }\n    conflicts.push(item);\n    this._addToLookupMap(item);\n  }\n  _addToLookupMap(item) {\n    if (!item.command) {\n      return;\n    }\n    let arr = this._lookupMap.get(item.command);\n    if (typeof arr === \"undefined\") {\n      arr = [item];\n      this._lookupMap.set(item.command, arr);\n    } else {\n      arr.push(item);\n    }\n  }\n  _removeFromLookupMap(item) {\n    if (!item.command) {\n      return;\n    }\n    const arr = this._lookupMap.get(item.command);\n    if (typeof arr === \"undefined\") {\n      return;\n    }\n    for (let i = 0, len = arr.length; i < len; i++) {\n      if (arr[i] === item) {\n        arr.splice(i, 1);\n        return;\n      }\n    }\n  }\n  static whenIsEntirelyIncluded(a, b) {\n    if (!b || b.type === 1) {\n      return true;\n    }\n    if (!a || a.type === 1) {\n      return false;\n    }\n    return (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js.implies)(a, b);\n  }\n  getKeybindings() {\n    return this._keybindings;\n  }\n  lookupPrimaryKeybinding(commandId, context) {\n    const items = this._lookupMap.get(commandId);\n    if (typeof items === \"undefined\" || items.length === 0) {\n      return null;\n    }\n    if (items.length === 1) {\n      return items[0];\n    }\n    for (let i = items.length - 1; i >= 0; i--) {\n      const item = items[i];\n      if (context.contextMatchesRules(item.when)) {\n        return item;\n      }\n    }\n    return items[items.length - 1];\n  }\n  resolve(context, currentChords, keypress) {\n    const pressedChords = [...currentChords, keypress];\n    this._log(`| Resolving ${pressedChords}`);\n    const kbCandidates = this._map.get(pressedChords[0]);\n    if (kbCandidates === undefined) {\n      this._log(`\\\\ No keybinding entries.`);\n      return NoMatchingKb;\n    }\n    let lookupMap = null;\n    if (pressedChords.length < 2) {\n      lookupMap = kbCandidates;\n    } else {\n      lookupMap = [];\n      for (let i = 0, len = kbCandidates.length; i < len; i++) {\n        const candidate = kbCandidates[i];\n        if (pressedChords.length > candidate.chords.length) {\n          continue;\n        }\n        let prefixMatches = true;\n        for (let i = 1; i < pressedChords.length; i++) {\n          if (candidate.chords[i] !== pressedChords[i]) {\n            prefixMatches = false;\n            break;\n          }\n        }\n        if (prefixMatches) {\n          lookupMap.push(candidate);\n        }\n      }\n    }\n    const result = this._findCommand(context, lookupMap);\n    if (!result) {\n      this._log(`\\\\ From ${lookupMap.length} keybinding entries, no when clauses matched the context.`);\n      return NoMatchingKb;\n    }\n    if (pressedChords.length < result.chords.length) {\n      this._log(`\\\\ From ${lookupMap.length} keybinding entries, awaiting ${result.chords.length - pressedChords.length} more chord(s), when: ${printWhenExplanation(result.when)}, source: ${printSourceExplanation(result)}.`);\n      return MoreChordsNeeded;\n    }\n    this._log(`\\\\ From ${lookupMap.length} keybinding entries, matched ${result.command}, when: ${printWhenExplanation(result.when)}, source: ${printSourceExplanation(result)}.`);\n    return KbFound(result.command, result.commandArgs, result.bubble);\n  }\n  _findCommand(context, matches) {\n    for (let i = matches.length - 1; i >= 0; i--) {\n      const k = matches[i];\n      if (!KeybindingResolver._contextMatchesRules(context, k.when)) {\n        continue;\n      }\n      return k;\n    }\n    return null;\n  }\n  static _contextMatchesRules(context, rules) {\n    if (!rules) {\n      return true;\n    }\n    return rules.evaluate(context);\n  }\n}\nfunction printWhenExplanation(when) {\n  if (!when) {\n    return `no when condition`;\n  }\n  return `${when.serialize()}`;\n}\nfunction printSourceExplanation(kb) {\n  return kb.extensionId ? kb.isBuiltinExtension ? `built-in extension ${kb.extensionId}` : `user extension ${kb.extensionId}` : kb.isDefault ? `built-in` : `user`;\n}\n\n};"],
"names":["shadow$provide","require","module","exports","printWhenExplanation","when","serialize","printSourceExplanation","kb","extensionId","isBuiltinExtension","isDefault","Object","defineProperties","__esModule","enumerable","value","KeybindingResolver","get","NoMatchingKb","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js","kind","MoreChordsNeeded","constructor","defaultKeybindings","overrides","log","_a","_log","_defaultKeybindings","_defaultBoundCommands","Map","defaultKeybinding","command","charAt","set","_map","_lookupMap","_keybindings","handleRemovals","concat","i","len","length","k","chords","substituteConstants","type","_addKeyPress","_isTargetedForRemoval","defaultKb","keypress","expressionsAreEqualWithConstantSubstitution","rules","removals","rule","substring","has","push","size","result","commandRemovals","isRemoved","commandRemoval","item","conflicts","conflict","isShorterKbPrefix","whenIsEntirelyIncluded","_removeFromLookupMap","_addToLookupMap","arr","splice","a","b","implies","getKeybindings","lookupPrimaryKeybinding","commandId","context","items","contextMatchesRules","resolve","currentChords","pressedChords","kbCandidates","undefined","lookupMap","candidate","prefixMatches","_findCommand","commandArgs","isBubble","bubble","matches","_contextMatchesRules","evaluate"]
}
