{
"version":3,
"file":"module$node_modules$vega_crossfilter$build$vega_crossfilter.js",
"lineCount":387,
"mappings":"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",
"sources":["node_modules/vega-crossfilter/build/vega-crossfilter.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$vega_crossfilter$build$vega_crossfilter\"] = function(require,module,exports) {\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('vega-dataflow'), require('vega-util')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'vega-dataflow', 'vega-util'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.vega = global.vega || {}, global.vega.transforms = {}), global.vega, global.vega));\n})(this, (function (exports, vegaDataflow, vegaUtil) { 'use strict';\n\n  const array8 = n => new Uint8Array(n);\n  const array16 = n => new Uint16Array(n);\n  const array32 = n => new Uint32Array(n);\n\n  /**\n   * Maintains CrossFilter state.\n   */\n  function Bitmaps() {\n    let width = 8,\n      data = [],\n      seen = array32(0),\n      curr = array(0, width),\n      prev = array(0, width);\n    return {\n      data: () => data,\n      seen: () => seen = lengthen(seen, data.length),\n      add(array) {\n        for (let i = 0, j = data.length, n = array.length, t; i < n; ++i) {\n          t = array[i];\n          t._index = j++;\n          data.push(t);\n        }\n      },\n      remove(num, map) {\n        // map: index -> boolean (true => remove)\n        const n = data.length,\n          copy = Array(n - num),\n          reindex = data; // reuse old data array for index map\n        let t, i, j;\n\n        // seek forward to first removal\n        for (i = 0; !map[i] && i < n; ++i) {\n          copy[i] = data[i];\n          reindex[i] = i;\n        }\n\n        // condense arrays\n        for (j = i; i < n; ++i) {\n          t = data[i];\n          if (!map[i]) {\n            reindex[i] = j;\n            curr[j] = curr[i];\n            prev[j] = prev[i];\n            copy[j] = t;\n            t._index = j++;\n          } else {\n            reindex[i] = -1;\n          }\n          curr[i] = 0; // clear unused bits\n        }\n        data = copy;\n        return reindex;\n      },\n      size: () => data.length,\n      curr: () => curr,\n      prev: () => prev,\n      reset: k => prev[k] = curr[k],\n      all: () => width < 0x101 ? 0xff : width < 0x10001 ? 0xffff : 0xffffffff,\n      set(k, one) {\n        curr[k] |= one;\n      },\n      clear(k, one) {\n        curr[k] &= ~one;\n      },\n      resize(n, m) {\n        const k = curr.length;\n        if (n > k || m > width) {\n          width = Math.max(m, width);\n          curr = array(n, width, curr);\n          prev = array(n, width);\n        }\n      }\n    };\n  }\n  function lengthen(array, length, copy) {\n    if (array.length >= length) return array;\n    copy = copy || new array.constructor(length);\n    copy.set(array);\n    return copy;\n  }\n  function array(n, m, array) {\n    const copy = (m < 0x101 ? array8 : m < 0x10001 ? array16 : array32)(n);\n    if (array) copy.set(array);\n    return copy;\n  }\n\n  function Dimension (index, i, query) {\n    const bit = 1 << i;\n    return {\n      one: bit,\n      zero: ~bit,\n      range: query.slice(),\n      bisect: index.bisect,\n      index: index.index,\n      size: index.size,\n      onAdd(added, curr) {\n        const dim = this,\n          range = dim.bisect(dim.range, added.value),\n          idx = added.index,\n          lo = range[0],\n          hi = range[1],\n          n1 = idx.length;\n        let i;\n        for (i = 0; i < lo; ++i) curr[idx[i]] |= bit;\n        for (i = hi; i < n1; ++i) curr[idx[i]] |= bit;\n        return dim;\n      }\n    };\n  }\n\n  function ascending(a, b) {\n    return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n  }\n\n  function descending(a, b) {\n    return a == null || b == null ? NaN : b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;\n  }\n\n  function bisector(f) {\n    let compare1, compare2, delta;\n\n    // If an accessor is specified, promote it to a comparator. In this case we\n    // can test whether the search value is (self-) comparable. We can\u2019t do this\n    // for a comparator (except for specific, known comparators) because we can\u2019t\n    // tell if the comparator is symmetric, and an asymmetric comparator can\u2019t be\n    // used to test whether a single value is comparable.\n    if (f.length !== 2) {\n      compare1 = ascending;\n      compare2 = (d, x) => ascending(f(d), x);\n      delta = (d, x) => f(d) - x;\n    } else {\n      compare1 = f === ascending || f === descending ? f : zero;\n      compare2 = f;\n      delta = f;\n    }\n    function left(a, x, lo = 0, hi = a.length) {\n      if (lo < hi) {\n        if (compare1(x, x) !== 0) return hi;\n        do {\n          const mid = lo + hi >>> 1;\n          if (compare2(a[mid], x) < 0) lo = mid + 1;else hi = mid;\n        } while (lo < hi);\n      }\n      return lo;\n    }\n    function right(a, x, lo = 0, hi = a.length) {\n      if (lo < hi) {\n        if (compare1(x, x) !== 0) return hi;\n        do {\n          const mid = lo + hi >>> 1;\n          if (compare2(a[mid], x) <= 0) lo = mid + 1;else hi = mid;\n        } while (lo < hi);\n      }\n      return lo;\n    }\n    function center(a, x, lo = 0, hi = a.length) {\n      const i = left(a, x, lo, hi - 1);\n      return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n    }\n    return {\n      left,\n      center,\n      right\n    };\n  }\n  function zero() {\n    return 0;\n  }\n\n  function number(x) {\n    return x === null ? NaN : +x;\n  }\n\n  const ascendingBisect = bisector(ascending);\n  const bisectRight = ascendingBisect.right;\n  const bisectLeft = ascendingBisect.left;\n  bisector(number).center;\n\n  function permute(source, keys) {\n    return Array.from(keys, key => source[key]);\n  }\n\n  /**\n   * Maintains a list of values, sorted by key.\n   */\n  function SortedIndex() {\n    let index = array32(0),\n      value = [],\n      size = 0;\n    function insert(key, data, base) {\n      if (!data.length) return [];\n      const n0 = size,\n        n1 = data.length,\n        addi = array32(n1);\n      let addv = Array(n1),\n        oldv,\n        oldi,\n        i;\n      for (i = 0; i < n1; ++i) {\n        addv[i] = key(data[i]);\n        addi[i] = i;\n      }\n      addv = sort(addv, addi);\n      if (n0) {\n        oldv = value;\n        oldi = index;\n        value = Array(n0 + n1);\n        index = array32(n0 + n1);\n        merge(base, oldv, oldi, n0, addv, addi, n1, value, index);\n      } else {\n        if (base > 0) for (i = 0; i < n1; ++i) {\n          addi[i] += base;\n        }\n        value = addv;\n        index = addi;\n      }\n      size = n0 + n1;\n      return {\n        index: addi,\n        value: addv\n      };\n    }\n    function remove(num, map) {\n      // map: index -> remove\n      const n = size;\n      let idx, i, j;\n\n      // seek forward to first removal\n      for (i = 0; !map[index[i]] && i < n; ++i);\n\n      // condense index and value arrays\n      for (j = i; i < n; ++i) {\n        if (!map[idx = index[i]]) {\n          index[j] = idx;\n          value[j] = value[i];\n          ++j;\n        }\n      }\n      size = n - num;\n    }\n    function reindex(map) {\n      for (let i = 0, n = size; i < n; ++i) {\n        index[i] = map[index[i]];\n      }\n    }\n    function bisect(range, array) {\n      let n;\n      if (array) {\n        n = array.length;\n      } else {\n        array = value;\n        n = size;\n      }\n      return [bisectLeft(array, range[0], 0, n), bisectRight(array, range[1], 0, n)];\n    }\n    return {\n      insert: insert,\n      remove: remove,\n      bisect: bisect,\n      reindex: reindex,\n      index: () => index,\n      size: () => size\n    };\n  }\n  function sort(values, index) {\n    values.sort.call(index, (a, b) => {\n      const x = values[a],\n        y = values[b];\n      return x < y ? -1 : x > y ? 1 : 0;\n    });\n    return permute(values, index);\n  }\n  function merge(base, value0, index0, n0, value1, index1, n1, value, index) {\n    let i0 = 0,\n      i1 = 0,\n      i;\n    for (i = 0; i0 < n0 && i1 < n1; ++i) {\n      if (value0[i0] < value1[i1]) {\n        value[i] = value0[i0];\n        index[i] = index0[i0++];\n      } else {\n        value[i] = value1[i1];\n        index[i] = index1[i1++] + base;\n      }\n    }\n    for (; i0 < n0; ++i0, ++i) {\n      value[i] = value0[i0];\n      index[i] = index0[i0];\n    }\n    for (; i1 < n1; ++i1, ++i) {\n      value[i] = value1[i1];\n      index[i] = index1[i1] + base;\n    }\n  }\n\n  /**\n   * An indexed multi-dimensional filter.\n   * @constructor\n   * @param {object} params - The parameters for this operator.\n   * @param {Array<function(object): *>} params.fields - An array of dimension accessors to filter.\n   * @param {Array} params.query - An array of per-dimension range queries.\n   */\n  function CrossFilter(params) {\n    vegaDataflow.Transform.call(this, Bitmaps(), params);\n    this._indices = null;\n    this._dims = null;\n  }\n  CrossFilter.Definition = {\n    'type': 'CrossFilter',\n    'metadata': {},\n    'params': [{\n      'name': 'fields',\n      'type': 'field',\n      'array': true,\n      'required': true\n    }, {\n      'name': 'query',\n      'type': 'array',\n      'array': true,\n      'required': true,\n      'content': {\n        'type': 'number',\n        'array': true,\n        'length': 2\n      }\n    }]\n  };\n  vegaUtil.inherits(CrossFilter, vegaDataflow.Transform, {\n    transform(_, pulse) {\n      if (!this._dims) {\n        return this.init(_, pulse);\n      } else {\n        var init = _.modified('fields') || _.fields.some(f => pulse.modified(f.fields));\n        return init ? this.reinit(_, pulse) : this.eval(_, pulse);\n      }\n    },\n    init(_, pulse) {\n      const fields = _.fields,\n        query = _.query,\n        indices = this._indices = {},\n        dims = this._dims = [],\n        m = query.length;\n      let i = 0,\n        key,\n        index;\n\n      // instantiate indices and dimensions\n      for (; i < m; ++i) {\n        key = fields[i].fname;\n        index = indices[key] || (indices[key] = SortedIndex());\n        dims.push(Dimension(index, i, query[i]));\n      }\n      return this.eval(_, pulse);\n    },\n    reinit(_, pulse) {\n      const output = pulse.materialize().fork(),\n        fields = _.fields,\n        query = _.query,\n        indices = this._indices,\n        dims = this._dims,\n        bits = this.value,\n        curr = bits.curr(),\n        prev = bits.prev(),\n        all = bits.all(),\n        out = output.rem = output.add,\n        mod = output.mod,\n        m = query.length,\n        adds = {};\n      let add, index, key, mods, remMap, modMap, i, n, f;\n\n      // set prev to current state\n      prev.set(curr);\n\n      // if pulse has remove tuples, process them first\n      if (pulse.rem.length) {\n        remMap = this.remove(_, pulse, output);\n      }\n\n      // if pulse has added tuples, add them to state\n      if (pulse.add.length) {\n        bits.add(pulse.add);\n      }\n\n      // if pulse has modified tuples, create an index map\n      if (pulse.mod.length) {\n        modMap = {};\n        for (mods = pulse.mod, i = 0, n = mods.length; i < n; ++i) {\n          modMap[mods[i]._index] = 1;\n        }\n      }\n\n      // re-initialize indices as needed, update curr bitmap\n      for (i = 0; i < m; ++i) {\n        f = fields[i];\n        if (!dims[i] || _.modified('fields', i) || pulse.modified(f.fields)) {\n          key = f.fname;\n          if (!(add = adds[key])) {\n            indices[key] = index = SortedIndex();\n            adds[key] = add = index.insert(f, pulse.source, 0);\n          }\n          dims[i] = Dimension(index, i, query[i]).onAdd(add, curr);\n        }\n      }\n\n      // visit each tuple\n      // if filter state changed, push index to add/rem\n      // else if in mod and passes a filter, push index to mod\n      for (i = 0, n = bits.data().length; i < n; ++i) {\n        if (remMap[i]) {\n          // skip if removed tuple\n          continue;\n        } else if (prev[i] !== curr[i]) {\n          // add if state changed\n          out.push(i);\n        } else if (modMap[i] && curr[i] !== all) {\n          // otherwise, pass mods through\n          mod.push(i);\n        }\n      }\n      bits.mask = (1 << m) - 1;\n      return output;\n    },\n    eval(_, pulse) {\n      const output = pulse.materialize().fork(),\n        m = this._dims.length;\n      let mask = 0;\n      if (pulse.rem.length) {\n        this.remove(_, pulse, output);\n        mask |= (1 << m) - 1;\n      }\n      if (_.modified('query') && !_.modified('fields')) {\n        mask |= this.update(_, pulse, output);\n      }\n      if (pulse.add.length) {\n        this.insert(_, pulse, output);\n        mask |= (1 << m) - 1;\n      }\n      if (pulse.mod.length) {\n        this.modify(pulse, output);\n        mask |= (1 << m) - 1;\n      }\n      this.value.mask = mask;\n      return output;\n    },\n    insert(_, pulse, output) {\n      const tuples = pulse.add,\n        bits = this.value,\n        dims = this._dims,\n        indices = this._indices,\n        fields = _.fields,\n        adds = {},\n        out = output.add,\n        n = bits.size() + tuples.length,\n        m = dims.length;\n      let k = bits.size(),\n        j,\n        key,\n        add;\n\n      // resize bitmaps and add tuples as needed\n      bits.resize(n, m);\n      bits.add(tuples);\n      const curr = bits.curr(),\n        prev = bits.prev(),\n        all = bits.all();\n\n      // add to dimensional indices\n      for (j = 0; j < m; ++j) {\n        key = fields[j].fname;\n        add = adds[key] || (adds[key] = indices[key].insert(fields[j], tuples, k));\n        dims[j].onAdd(add, curr);\n      }\n\n      // set previous filters, output if passes at least one filter\n      for (; k < n; ++k) {\n        prev[k] = all;\n        if (curr[k] !== all) out.push(k);\n      }\n    },\n    modify(pulse, output) {\n      const out = output.mod,\n        bits = this.value,\n        curr = bits.curr(),\n        all = bits.all(),\n        tuples = pulse.mod;\n      let i, n, k;\n      for (i = 0, n = tuples.length; i < n; ++i) {\n        k = tuples[i]._index;\n        if (curr[k] !== all) out.push(k);\n      }\n    },\n    remove(_, pulse, output) {\n      const indices = this._indices,\n        bits = this.value,\n        curr = bits.curr(),\n        prev = bits.prev(),\n        all = bits.all(),\n        map = {},\n        out = output.rem,\n        tuples = pulse.rem;\n      let i, n, k, f;\n\n      // process tuples, output if passes at least one filter\n      for (i = 0, n = tuples.length; i < n; ++i) {\n        k = tuples[i]._index;\n        map[k] = 1; // build index map\n        prev[k] = f = curr[k];\n        curr[k] = all;\n        if (f !== all) out.push(k);\n      }\n\n      // remove from dimensional indices\n      for (k in indices) {\n        indices[k].remove(n, map);\n      }\n      this.reindex(pulse, n, map);\n      return map;\n    },\n    // reindex filters and indices after propagation completes\n    reindex(pulse, num, map) {\n      const indices = this._indices,\n        bits = this.value;\n      pulse.runAfter(() => {\n        const indexMap = bits.remove(num, map);\n        for (const key in indices) indices[key].reindex(indexMap);\n      });\n    },\n    update(_, pulse, output) {\n      const dims = this._dims,\n        query = _.query,\n        stamp = pulse.stamp,\n        m = dims.length;\n      let mask = 0,\n        i,\n        q;\n\n      // survey how many queries have changed\n      output.filters = 0;\n      for (q = 0; q < m; ++q) {\n        if (_.modified('query', q)) {\n          i = q;\n          ++mask;\n        }\n      }\n      if (mask === 1) {\n        // only one query changed, use more efficient update\n        mask = dims[i].one;\n        this.incrementOne(dims[i], query[i], output.add, output.rem);\n      } else {\n        // multiple queries changed, perform full record keeping\n        for (q = 0, mask = 0; q < m; ++q) {\n          if (!_.modified('query', q)) continue;\n          mask |= dims[q].one;\n          this.incrementAll(dims[q], query[q], stamp, output.add);\n          output.rem = output.add; // duplicate add/rem for downstream resolve\n        }\n      }\n      return mask;\n    },\n    incrementAll(dim, query, stamp, out) {\n      const bits = this.value,\n        seen = bits.seen(),\n        curr = bits.curr(),\n        prev = bits.prev(),\n        index = dim.index(),\n        old = dim.bisect(dim.range),\n        range = dim.bisect(query),\n        lo1 = range[0],\n        hi1 = range[1],\n        lo0 = old[0],\n        hi0 = old[1],\n        one = dim.one;\n      let i, j, k;\n\n      // Fast incremental update based on previous lo index.\n      if (lo1 < lo0) {\n        for (i = lo1, j = Math.min(lo0, hi1); i < j; ++i) {\n          k = index[i];\n          if (seen[k] !== stamp) {\n            prev[k] = curr[k];\n            seen[k] = stamp;\n            out.push(k);\n          }\n          curr[k] ^= one;\n        }\n      } else if (lo1 > lo0) {\n        for (i = lo0, j = Math.min(lo1, hi0); i < j; ++i) {\n          k = index[i];\n          if (seen[k] !== stamp) {\n            prev[k] = curr[k];\n            seen[k] = stamp;\n            out.push(k);\n          }\n          curr[k] ^= one;\n        }\n      }\n\n      // Fast incremental update based on previous hi index.\n      if (hi1 > hi0) {\n        for (i = Math.max(lo1, hi0), j = hi1; i < j; ++i) {\n          k = index[i];\n          if (seen[k] !== stamp) {\n            prev[k] = curr[k];\n            seen[k] = stamp;\n            out.push(k);\n          }\n          curr[k] ^= one;\n        }\n      } else if (hi1 < hi0) {\n        for (i = Math.max(lo0, hi1), j = hi0; i < j; ++i) {\n          k = index[i];\n          if (seen[k] !== stamp) {\n            prev[k] = curr[k];\n            seen[k] = stamp;\n            out.push(k);\n          }\n          curr[k] ^= one;\n        }\n      }\n      dim.range = query.slice();\n    },\n    incrementOne(dim, query, add, rem) {\n      const bits = this.value,\n        curr = bits.curr(),\n        index = dim.index(),\n        old = dim.bisect(dim.range),\n        range = dim.bisect(query),\n        lo1 = range[0],\n        hi1 = range[1],\n        lo0 = old[0],\n        hi0 = old[1],\n        one = dim.one;\n      let i, j, k;\n\n      // Fast incremental update based on previous lo index.\n      if (lo1 < lo0) {\n        for (i = lo1, j = Math.min(lo0, hi1); i < j; ++i) {\n          k = index[i];\n          curr[k] ^= one;\n          add.push(k);\n        }\n      } else if (lo1 > lo0) {\n        for (i = lo0, j = Math.min(lo1, hi0); i < j; ++i) {\n          k = index[i];\n          curr[k] ^= one;\n          rem.push(k);\n        }\n      }\n\n      // Fast incremental update based on previous hi index.\n      if (hi1 > hi0) {\n        for (i = Math.max(lo1, hi0), j = hi1; i < j; ++i) {\n          k = index[i];\n          curr[k] ^= one;\n          add.push(k);\n        }\n      } else if (hi1 < hi0) {\n        for (i = Math.max(lo0, hi1), j = hi0; i < j; ++i) {\n          k = index[i];\n          curr[k] ^= one;\n          rem.push(k);\n        }\n      }\n      dim.range = query.slice();\n    }\n  });\n\n  /**\n   * Selectively filters tuples by resolving against a filter bitmap.\n   * Useful for processing the output of a cross-filter transform.\n   * @constructor\n   * @param {object} params - The parameters for this operator.\n   * @param {object} params.ignore - A bit mask indicating which filters to ignore.\n   * @param {object} params.filter - The per-tuple filter bitmaps. Typically this\n   *   parameter value is a reference to a {@link CrossFilter} transform.\n   */\n  function ResolveFilter(params) {\n    vegaDataflow.Transform.call(this, null, params);\n  }\n  ResolveFilter.Definition = {\n    'type': 'ResolveFilter',\n    'metadata': {},\n    'params': [{\n      'name': 'ignore',\n      'type': 'number',\n      'required': true,\n      'description': 'A bit mask indicating which filters to ignore.'\n    }, {\n      'name': 'filter',\n      'type': 'object',\n      'required': true,\n      'description': 'Per-tuple filter bitmaps from a CrossFilter transform.'\n    }]\n  };\n  vegaUtil.inherits(ResolveFilter, vegaDataflow.Transform, {\n    transform(_, pulse) {\n      const ignore = ~(_.ignore || 0),\n        // bit mask where zeros -> dims to ignore\n        bitmap = _.filter,\n        mask = bitmap.mask;\n\n      // exit early if no relevant filter changes\n      if ((mask & ignore) === 0) return pulse.StopPropagation;\n      const output = pulse.fork(pulse.ALL),\n        data = bitmap.data(),\n        curr = bitmap.curr(),\n        prev = bitmap.prev(),\n        pass = k => !(curr[k] & ignore) ? data[k] : null;\n\n      // propagate all mod tuples that pass the filter\n      output.filter(output.MOD, pass);\n\n      // determine add & rem tuples via filter functions\n      // for efficiency, we do *not* populate new arrays,\n      // instead we add filter functions applied downstream\n\n      if (!(mask & mask - 1)) {\n        // only one filter changed\n        output.filter(output.ADD, pass);\n        output.filter(output.REM, k => (curr[k] & ignore) === mask ? data[k] : null);\n      } else {\n        // multiple filters changed\n        output.filter(output.ADD, k => {\n          const c = curr[k] & ignore,\n            f = !c && c ^ prev[k] & ignore;\n          return f ? data[k] : null;\n        });\n        output.filter(output.REM, k => {\n          const c = curr[k] & ignore,\n            f = c && !(c ^ (c ^ prev[k] & ignore));\n          return f ? data[k] : null;\n        });\n      }\n\n      // add filter to source data in case of reflow...\n      return output.filter(output.SOURCE, t => pass(t._index));\n    }\n  });\n\n  exports.crossfilter = CrossFilter;\n  exports.resolvefilter = ResolveFilter;\n\n}));\n\n};"],
"names":["shadow$provide","require","module","exports","global","factory","define","amd","globalThis","self","vega","transforms","vegaDataflow","vegaUtil","Bitmaps","width","data","seen","Uint32Array","n","curr","array","prev","length","copy","constructor","set","add","i","j","t","_index","push","remove","num","map","Array","reindex","size","reset","k","all","one","clear","resize","m","Math","max","array8","array16","array32","Dimension","index","query","bit","zero","range","slice","bisect","onAdd","added","dim","value","idx","lo","hi","n1","ascending","a","b","NaN","descending","bisector","f","left","x","compare1","mid","compare2","delta","d","center","right","permute","source","keys","from","key","SortedIndex","insert","base","n0","addi","addv","sort","oldv","oldi","i0","i1","value1","bisectLeft","bisectRight","values","call","y","CrossFilter","params","Transform","_dims","_indices","ResolveFilter","Uint8Array","Uint16Array","ascendingBisect","number","Definition","inherits","transform","_","pulse","modified","fields","some","reinit","eval","init","indices","dims","fname","output","materialize","fork","bits","out","rem","mod","adds","remMap","modMap","mods","mask","update","modify","tuples","runAfter","indexMap","stamp","q","filters","incrementOne","incrementAll","old","lo1","hi1","lo0","hi0","min","ignore","bitmap","filter","StopPropagation","ALL","pass","MOD","ADD","c","REM","SOURCE","crossfilter","resolvefilter"]
}
