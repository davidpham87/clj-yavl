shadow$provide.module$node_modules$monaco_editor$esm$vs$base$browser$defaultWorkerFactory = function(require, module, exports) {
  function getWorker(label) {
    var monacoEnvironment = globalThis.MonacoEnvironment;
    if (monacoEnvironment) {
      if (typeof monacoEnvironment.getWorker === "function") {
        return monacoEnvironment.getWorker("workerMain.js", label);
      }
      if (typeof monacoEnvironment.getWorkerUrl === "function") {
        return monacoEnvironment = monacoEnvironment.getWorkerUrl("workerMain.js", label), new Worker(ttPolicy ? ttPolicy.createScriptURL(monacoEnvironment) : monacoEnvironment, {name:label});
      }
    }
    throw Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker");
  }
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, DefaultWorkerFactory:{enumerable:!0, get:function() {
    return DefaultWorkerFactory;
  }}});
  module = require("module$node_modules$monaco_editor$esm$vs$base$browser$trustedTypes");
  var require$_DOT__DOT__SLASH_common_SLASH_errors_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$errors"), require$_DOT__DOT__SLASH_common_SLASH_worker_SLASH_simpleWorker_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$worker$simpleWorker");
  const ttPolicy = (0,module.createTrustedTypesPolicy)("defaultWorkerFactory", {createScriptURL:value => value});
  class WebWorker {
    constructor(moduleId, id, label, onMessageCallback, onErrorCallback) {
      this.id = id;
      this.label = label;
      id = getWorker(label);
      label = typeof id.then === "function" ? !0 : !1;
      this.worker = label ? id : Promise.resolve(id);
      this.postMessage(moduleId, []);
      this.worker.then(w => {
        w.onmessage = function(ev) {
          onMessageCallback(ev.data);
        };
        w.onmessageerror = onErrorCallback;
        typeof w.addEventListener === "function" && w.addEventListener("error", onErrorCallback);
      });
    }
    getId() {
      return this.id;
    }
    postMessage(message, transfer) {
      var _a;
      (_a = this.worker) === null || _a === void 0 || _a.then(w => {
        try {
          w.postMessage(message, transfer);
        } catch (err) {
          (0,require$_DOT__DOT__SLASH_common_SLASH_errors_DOT_js.onUnexpectedError)(err), (0,require$_DOT__DOT__SLASH_common_SLASH_errors_DOT_js.onUnexpectedError)(Error(`FAILED to post message to '${this.label}'-worker`, {cause:err}));
        }
      });
    }
    dispose() {
      var _a;
      (_a = this.worker) === null || _a === void 0 || _a.then(w => w.terminate());
      this.worker = null;
    }
  }
  class DefaultWorkerFactory {
    constructor(label) {
      this._label = label;
      this._webWorkerFailedBeforeError = !1;
    }
    create(moduleId, onMessageCallback, onErrorCallback) {
      const workerId = ++DefaultWorkerFactory.LAST_WORKER_ID;
      if (this._webWorkerFailedBeforeError) {
        throw this._webWorkerFailedBeforeError;
      }
      return new WebWorker(moduleId, workerId, this._label || "anonymous" + workerId, onMessageCallback, err => {
        (0,require$_DOT__DOT__SLASH_common_SLASH_worker_SLASH_simpleWorker_DOT_js.logOnceWebWorkerWarning)(err);
        this._webWorkerFailedBeforeError = err;
        onErrorCallback(err);
      });
    }
  }
  DefaultWorkerFactory.LAST_WORKER_ID = 0;
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$base$browser$defaultWorkerFactory.js.map
