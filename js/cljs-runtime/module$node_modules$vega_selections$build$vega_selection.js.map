{
"version":3,
"file":"module$node_modules$vega_selections$build$vega_selection.js",
"lineCount":277,
"mappings":"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",
"sources":["node_modules/vega-selections/build/vega-selection.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$vega_selections$build$vega_selection\"] = function(require,module,exports) {\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('vega-util'), require('vega-expression')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'vega-util', 'vega-expression'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.vega = {}, global.vega, global.vega));\n})(this, (function (exports, vegaUtil, vegaExpression) { 'use strict';\n\n  function ascending(a, b) {\n    return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n  }\n\n  function descending(a, b) {\n    return a == null || b == null ? NaN : b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;\n  }\n\n  function bisector(f) {\n    let compare1, compare2, delta;\n\n    // If an accessor is specified, promote it to a comparator. In this case we\n    // can test whether the search value is (self-) comparable. We can\u2019t do this\n    // for a comparator (except for specific, known comparators) because we can\u2019t\n    // tell if the comparator is symmetric, and an asymmetric comparator can\u2019t be\n    // used to test whether a single value is comparable.\n    if (f.length !== 2) {\n      compare1 = ascending;\n      compare2 = (d, x) => ascending(f(d), x);\n      delta = (d, x) => f(d) - x;\n    } else {\n      compare1 = f === ascending || f === descending ? f : zero;\n      compare2 = f;\n      delta = f;\n    }\n    function left(a, x, lo = 0, hi = a.length) {\n      if (lo < hi) {\n        if (compare1(x, x) !== 0) return hi;\n        do {\n          const mid = lo + hi >>> 1;\n          if (compare2(a[mid], x) < 0) lo = mid + 1;else hi = mid;\n        } while (lo < hi);\n      }\n      return lo;\n    }\n    function right(a, x, lo = 0, hi = a.length) {\n      if (lo < hi) {\n        if (compare1(x, x) !== 0) return hi;\n        do {\n          const mid = lo + hi >>> 1;\n          if (compare2(a[mid], x) <= 0) lo = mid + 1;else hi = mid;\n        } while (lo < hi);\n      }\n      return lo;\n    }\n    function center(a, x, lo = 0, hi = a.length) {\n      const i = left(a, x, lo, hi - 1);\n      return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n    }\n    return {\n      left,\n      center,\n      right\n    };\n  }\n  function zero() {\n    return 0;\n  }\n\n  class InternSet extends Set {\n    constructor(values, key = keyof) {\n      super();\n      Object.defineProperties(this, {\n        _intern: {\n          value: new Map()\n        },\n        _key: {\n          value: key\n        }\n      });\n      if (values != null) for (const value of values) this.add(value);\n    }\n    has(value) {\n      return super.has(intern_get(this, value));\n    }\n    add(value) {\n      return super.add(intern_set(this, value));\n    }\n    delete(value) {\n      return super.delete(intern_delete(this, value));\n    }\n  }\n  function intern_get({\n    _intern,\n    _key\n  }, value) {\n    const key = _key(value);\n    return _intern.has(key) ? _intern.get(key) : value;\n  }\n  function intern_set({\n    _intern,\n    _key\n  }, value) {\n    const key = _key(value);\n    if (_intern.has(key)) return _intern.get(key);\n    _intern.set(key, value);\n    return value;\n  }\n  function intern_delete({\n    _intern,\n    _key\n  }, value) {\n    const key = _key(value);\n    if (_intern.has(key)) {\n      value = _intern.get(key);\n      _intern.delete(key);\n    }\n    return value;\n  }\n  function keyof(value) {\n    return value !== null && typeof value === \"object\" ? value.valueOf() : value;\n  }\n\n  function intersection(values, ...others) {\n    values = new InternSet(values);\n    others = others.map(set);\n    out: for (const value of values) {\n      for (const other of others) {\n        if (!other.has(value)) {\n          values.delete(value);\n          continue out;\n        }\n      }\n    }\n    return values;\n  }\n  function set(values) {\n    return values instanceof InternSet ? values : new InternSet(values);\n  }\n\n  function union(...others) {\n    const set = new InternSet();\n    for (const other of others) {\n      for (const o of other) {\n        set.add(o);\n      }\n    }\n    return set;\n  }\n\n  // Registers vega-util field accessors to protect against XSS attacks\n  const SELECTION_GETTER = Symbol('vega_selection_getter');\n  function getter(f) {\n    if (!f.getter || !f.getter[SELECTION_GETTER]) {\n      f.getter = vegaUtil.field(f.field);\n      f.getter[SELECTION_GETTER] = true;\n    }\n    return f.getter;\n  }\n  const Intersect = 'intersect';\n  const Union = 'union';\n  const VlMulti = 'vlMulti';\n  const VlPoint = 'vlPoint';\n  const Or = 'or';\n  const And = 'and';\n  const SelectionId = '_vgsid_';\n  const $selectionId = vegaUtil.field(SelectionId);\n\n  const TYPE_ENUM = 'E',\n    TYPE_RANGE_INC = 'R',\n    TYPE_RANGE_EXC = 'R-E',\n    TYPE_RANGE_LE = 'R-LE',\n    TYPE_RANGE_RE = 'R-RE',\n    TYPE_PRED_LT = 'E-LT',\n    TYPE_PRED_LTE = 'E-LTE',\n    TYPE_PRED_GT = 'E-GT',\n    TYPE_PRED_GTE = 'E-GTE',\n    TYPE_PRED_VALID = 'E-VALID',\n    TYPE_PRED_ONE_OF = 'E-ONE',\n    UNIT_INDEX = 'index:unit';\n\n  // TODO: revisit date coercion?\n  function testPoint(datum, entry) {\n    var fields = entry.fields,\n      values = entry.values,\n      n = fields.length,\n      i = 0,\n      dval,\n      f;\n    for (; i < n; ++i) {\n      f = fields[i];\n      dval = getter(f)(datum);\n      if (vegaUtil.isDate(dval)) dval = vegaUtil.toNumber(dval);\n      if (vegaUtil.isDate(values[i])) values[i] = vegaUtil.toNumber(values[i]);\n      if (vegaUtil.isArray(values[i]) && vegaUtil.isDate(values[i][0])) values[i] = values[i].map(vegaUtil.toNumber);\n      if (f.type === TYPE_ENUM) {\n        // Enumerated fields can either specify individual values (single/multi selections)\n        // or an array of values (interval selections).\n        if (vegaUtil.isArray(values[i]) ? !values[i].includes(dval) : dval !== values[i]) {\n          return false;\n        }\n      } else {\n        if (f.type === TYPE_RANGE_INC) {\n          if (!vegaUtil.inrange(dval, values[i])) return false;\n        } else if (f.type === TYPE_RANGE_RE) {\n          // Discrete selection of bins test within the range [bin_start, bin_end).\n          if (!vegaUtil.inrange(dval, values[i], true, false)) return false;\n        } else if (f.type === TYPE_RANGE_EXC) {\n          // 'R-E'/'R-LE' included for completeness.\n          if (!vegaUtil.inrange(dval, values[i], false, false)) return false;\n        } else if (f.type === TYPE_RANGE_LE) {\n          if (!vegaUtil.inrange(dval, values[i], false, true)) return false;\n        } else if (f.type === TYPE_PRED_LT) {\n          if (dval >= values[i]) return false;\n        } else if (f.type === TYPE_PRED_LTE) {\n          if (dval > values[i]) return false;\n        } else if (f.type === TYPE_PRED_GT) {\n          if (dval <= values[i]) return false;\n        } else if (f.type === TYPE_PRED_GTE) {\n          if (dval < values[i]) return false;\n        } else if (f.type === TYPE_PRED_VALID) {\n          if (dval === null || isNaN(dval)) return false;\n        } else if (f.type === TYPE_PRED_ONE_OF) {\n          if (values[i].indexOf(dval) === -1) return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Tests if a tuple is contained within an interactive selection.\n   * @param {string} name - The name of the data set representing the selection.\n   *  Tuples in the dataset are of the form\n   *  {unit: string, fields: array<fielddef>, values: array<*>}.\n   *  Fielddef is of the form\n   *  {field: string, channel: string, type: 'E' | 'R'} where\n   *  'type' identifies whether tuples in the dataset enumerate\n   *  values for the field, or specify a continuous range.\n   * @param {object} datum - The tuple to test for inclusion.\n   * @param {string} op - The set operation for combining selections.\n   *   One of 'intersect' or 'union' (default).\n   * @return {boolean} - True if the datum is in the selection, false otherwise.\n   */\n  function selectionTest(name, datum, op) {\n    var data = this.context.data[name],\n      entries = data ? data.values.value : [],\n      unitIdx = data ? data[UNIT_INDEX] && data[UNIT_INDEX].value : undefined,\n      intersect = op === Intersect,\n      n = entries.length,\n      i = 0,\n      entry,\n      miss,\n      count,\n      unit,\n      b;\n    for (; i < n; ++i) {\n      entry = entries[i];\n      if (unitIdx && intersect) {\n        // multi selections union within the same unit and intersect across units.\n        miss = miss || {};\n        count = miss[unit = entry.unit] || 0;\n\n        // if we've already matched this unit, skip.\n        if (count === -1) continue;\n        b = testPoint(datum, entry);\n        miss[unit] = b ? -1 : ++count;\n\n        // if we match and there are no other units return true\n        // if we've missed against all tuples in this unit return false\n        if (b && unitIdx.size === 1) return true;\n        if (!b && count === unitIdx.get(unit).count) return false;\n      } else {\n        b = testPoint(datum, entry);\n\n        // if we find a miss and we do require intersection return false\n        // if we find a match and we don't require intersection return true\n        if (intersect ^ b) return b;\n      }\n    }\n\n    // if intersecting and we made it here, then we saw no misses\n    // if not intersecting, then we saw no matches\n    // if no active selections, return false\n    return n && intersect;\n  }\n  const bisect = bisector($selectionId),\n    bisectLeft = bisect.left,\n    bisectRight = bisect.right;\n  function selectionIdTest(name, datum, op) {\n    const data = this.context.data[name],\n      entries = data ? data.values.value : [],\n      unitIdx = data ? data[UNIT_INDEX] && data[UNIT_INDEX].value : undefined,\n      intersect = op === Intersect,\n      value = $selectionId(datum),\n      index = bisectLeft(entries, value);\n    if (index === entries.length) return false;\n    if ($selectionId(entries[index]) !== value) return false;\n    if (unitIdx && intersect) {\n      if (unitIdx.size === 1) return true;\n      if (bisectRight(entries, value) - index < unitIdx.size) return false;\n    }\n    return true;\n  }\n\n  /**\n   * Maps an array of scene graph items to an array of selection tuples.\n   * @param {array} array - Input scene graph items\n   * @param {object} base - The base object that generated tuples extend.\n   *\n   * @returns {array} An array of selection entries for the given unit.\n   */\n  function selectionTuples(array, base) {\n    if (!vegaUtil.isArray(array)) {\n      vegaUtil.error('First argument to selectionTuples must be an array.');\n    }\n    if (!vegaUtil.isObject(base)) {\n      vegaUtil.error('Second argument to selectionTuples must be an object.');\n    }\n    return array.map(x => vegaUtil.extend(base.fields ? {\n      values: base.fields.map(f => getter(f)(x.datum))\n    } : {\n      [SelectionId]: $selectionId(x.datum)\n    }, base));\n  }\n\n  /**\n   * Resolves selection for use as a scale domain or reads via the API.\n   * @param {string} name - The name of the dataset representing the selection\n   * @param {string} [op='union'] - The set operation for combining selections.\n   *                 One of 'intersect' or 'union' (default).\n   * @param {boolean} isMulti - Identifies a \"multi\" selection to perform more\n   *                 expensive resolution computation.\n   * @param {boolean} vl5 - With Vega-Lite v5, \"multi\" selections are now called \"point\"\n   *                 selections, and thus the resolved tuple should reflect this name.\n   *                 This parameter allows us to reflect this change without triggering\n   *                 a major version bump for Vega.\n   * @returns {object} An object of selected fields and values.\n   */\n  function selectionResolve(name, op, isMulti, vl5) {\n    var data = this.context.data[name],\n      entries = data ? data.values.value : [],\n      resolved = {},\n      multiRes = {},\n      types = {},\n      entry,\n      fields,\n      values,\n      unit,\n      field,\n      value,\n      res,\n      resUnit,\n      type,\n      union,\n      n = entries.length,\n      i = 0,\n      j,\n      m;\n\n    // First union all entries within the same unit.\n    for (; i < n; ++i) {\n      entry = entries[i];\n      unit = entry.unit;\n      fields = entry.fields;\n      values = entry.values;\n      if (fields && values) {\n        // Intentional selection stores\n        for (j = 0, m = fields.length; j < m; ++j) {\n          field = fields[j];\n          res = resolved[field.field] || (resolved[field.field] = {});\n          resUnit = res[unit] || (res[unit] = []);\n          types[field.field] = type = field.type.charAt(0);\n          union = ops[`${type}_union`];\n          res[unit] = union(resUnit, vegaUtil.array(values[j]));\n        }\n\n        // If the same multi-selection is repeated over views and projected over\n        // an encoding, it may operate over different fields making it especially\n        // tricky to reliably resolve it. At best, we can de-dupe identical entries\n        // but doing so may be more computationally expensive than it is worth.\n        // Instead, for now, we simply transform our store representation into\n        // a more human-friendly one.\n        if (isMulti) {\n          resUnit = multiRes[unit] || (multiRes[unit] = []);\n          resUnit.push(vegaUtil.array(values).reduce((obj, curr, j) => (obj[fields[j].field] = curr, obj), {}));\n        }\n      } else {\n        // Short circuit extensional selectionId stores which hold sorted IDs unique to each unit.\n        field = SelectionId;\n        value = $selectionId(entry);\n        res = resolved[field] || (resolved[field] = {});\n        resUnit = res[unit] || (res[unit] = []);\n        resUnit.push(value);\n        if (isMulti) {\n          resUnit = multiRes[unit] || (multiRes[unit] = []);\n          resUnit.push({\n            [SelectionId]: value\n          });\n        }\n      }\n    }\n\n    // Then resolve fields across units as per the op.\n    op = op || Union;\n    if (resolved[SelectionId]) {\n      resolved[SelectionId] = ops[`${SelectionId}_${op}`](...Object.values(resolved[SelectionId]));\n    } else {\n      Object.keys(resolved).forEach(field => {\n        resolved[field] = Object.keys(resolved[field]).map(unit => resolved[field][unit]).reduce((acc, curr) => acc === undefined ? curr : ops[`${types[field]}_${op}`](acc, curr));\n      });\n    }\n    entries = Object.keys(multiRes);\n    if (isMulti && entries.length) {\n      const key = vl5 ? VlPoint : VlMulti;\n      resolved[key] = op === Union ? {\n        [Or]: entries.reduce((acc, k) => (acc.push(...multiRes[k]), acc), [])\n      } : {\n        [And]: entries.map(k => ({\n          [Or]: multiRes[k]\n        }))\n      };\n    }\n    return resolved;\n  }\n  var ops = {\n    [`${SelectionId}_union`]: union,\n    [`${SelectionId}_intersect`]: intersection,\n    E_union: function (base, value) {\n      if (!base.length) return value;\n      var i = 0,\n        n = value.length;\n      for (; i < n; ++i) if (!base.includes(value[i])) base.push(value[i]);\n      return base;\n    },\n    E_intersect: function (base, value) {\n      return !base.length ? value : base.filter(v => value.includes(v));\n    },\n    R_union: function (base, value) {\n      var lo = vegaUtil.toNumber(value[0]),\n        hi = vegaUtil.toNumber(value[1]);\n      if (lo > hi) {\n        lo = value[1];\n        hi = value[0];\n      }\n      if (!base.length) return [lo, hi];\n      if (base[0] > lo) base[0] = lo;\n      if (base[1] < hi) base[1] = hi;\n      return base;\n    },\n    R_intersect: function (base, value) {\n      var lo = vegaUtil.toNumber(value[0]),\n        hi = vegaUtil.toNumber(value[1]);\n      if (lo > hi) {\n        lo = value[1];\n        hi = value[0];\n      }\n      if (!base.length) return [lo, hi];\n      if (hi < base[0] || base[1] < lo) {\n        return [];\n      } else {\n        if (base[0] < lo) base[0] = lo;\n        if (base[1] > hi) base[1] = hi;\n      }\n      return base;\n    }\n  };\n\n  const DataPrefix = ':',\n    IndexPrefix = '@';\n  function selectionVisitor(name, args, scope, params) {\n    if (args[0].type !== vegaExpression.Literal) vegaUtil.error('First argument to selection functions must be a string literal.');\n    const data = args[0].value,\n      op = args.length >= 2 && vegaUtil.peek(args).value,\n      field = 'unit',\n      indexName = IndexPrefix + field,\n      dataName = DataPrefix + data;\n\n    // eslint-disable-next-line no-prototype-builtins\n    if (op === Intersect && !vegaUtil.hasOwnProperty(params, indexName)) {\n      params[indexName] = scope.getData(data).indataRef(scope, field);\n    }\n\n    // eslint-disable-next-line no-prototype-builtins\n    if (!vegaUtil.hasOwnProperty(params, dataName)) {\n      params[dataName] = scope.getData(data).tuplesRef();\n    }\n  }\n\n  exports.selectionIdTest = selectionIdTest;\n  exports.selectionResolve = selectionResolve;\n  exports.selectionTest = selectionTest;\n  exports.selectionTuples = selectionTuples;\n  exports.selectionVisitor = selectionVisitor;\n\n}));\n\n};"],
"names":["shadow$provide","require","module","exports","global","factory","define","amd","globalThis","self","vega","vegaUtil","vegaExpression","ascending","a","b","NaN","descending","zero","intern_get","_intern","_key","value","key","has","get","intern_set","set","intern_delete","delete","keyof","valueOf","values","InternSet","getter","f","SELECTION_GETTER","field","testPoint","datum","entry","fields","n","length","i","dval","isDate","toNumber","isArray","map","type","TYPE_ENUM","includes","TYPE_RANGE_INC","inrange","TYPE_RANGE_RE","TYPE_RANGE_EXC","TYPE_RANGE_LE","TYPE_PRED_LT","TYPE_PRED_LTE","TYPE_PRED_GT","TYPE_PRED_GTE","TYPE_PRED_VALID","isNaN","TYPE_PRED_ONE_OF","indexOf","Set","constructor","Object","defineProperties","Map","add","Symbol","$selectionId","SelectionId","bisect","bisector","left","x","lo","hi","compare1","mid","compare2","delta","d","center","right","bisectLeft","bisectRight","ops","union","others","other","o","intersection","E_union","base","push","E_intersect","filter","v","R_union","R_intersect","selectionIdTest","name","op","data","context","entries","unitIdx","UNIT_INDEX","undefined","intersect","Intersect","index","size","selectionResolve","isMulti","vl5","resolved","multiRes","types","unit","resUnit","j","m","res","charAt","array","reduce","obj","curr","Union","keys","forEach","acc","VlPoint","VlMulti","k","selectionTest","miss","count","selectionTuples","error","isObject","extend","selectionVisitor","args","scope","params","Literal","peek","dataName","DataPrefix","hasOwnProperty","indexName","getData","indataRef","tuplesRef"]
}
