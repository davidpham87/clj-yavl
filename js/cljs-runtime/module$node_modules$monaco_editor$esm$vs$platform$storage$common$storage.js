shadow$provide.module$node_modules$monaco_editor$esm$vs$platform$storage$common$storage = function(require, module, exports) {
  function loadKeyTargets(storage) {
    if (storage = storage.get("__$__targetStorageMarker")) {
      try {
        return JSON.parse(storage);
      } catch (error) {
      }
    }
    return Object.create(null);
  }
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, AbstractStorageService:{enumerable:!0, get:function() {
    return AbstractStorageService;
  }}, IStorageService:{enumerable:!0, get:function() {
    return IStorageService;
  }}, InMemoryStorageService:{enumerable:!0, get:function() {
    return InMemoryStorageService;
  }}, TARGET_KEY:{enumerable:!0, get:function() {
    return "__$__targetStorageMarker";
  }}, WillSaveStateReason:{enumerable:!0, get:function() {
    return WillSaveStateReason;
  }}, loadKeyTargets:{enumerable:!0, get:function() {
    return loadKeyTargets;
  }}});
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$event");
  module = require("module$node_modules$monaco_editor$esm$vs$base$common$lifecycle");
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_types_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$types"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$parts$storage$common$storage");
  const IStorageService = (0,require("module$node_modules$monaco_editor$esm$vs$platform$instantiation$common$instantiation").createDecorator)("storageService");
  var WillSaveStateReason;
  (function(WillSaveStateReason) {
    WillSaveStateReason[WillSaveStateReason.NONE = 0] = "NONE";
    WillSaveStateReason[WillSaveStateReason.SHUTDOWN = 1] = "SHUTDOWN";
  })(WillSaveStateReason ||= {});
  class AbstractStorageService extends module.Disposable {
    constructor(options = {flushInterval:AbstractStorageService.DEFAULT_FLUSH_INTERVAL}) {
      super();
      this.options = options;
      this._onDidChangeValue = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.PauseableEmitter());
      this._onDidChangeTarget = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.PauseableEmitter());
      this._onWillSaveState = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Emitter());
      this.onWillSaveState = this._onWillSaveState.event;
      this._applicationKeyTargets = this._profileKeyTargets = this._workspaceKeyTargets = void 0;
    }
    onDidChangeValue(scope, key, disposable) {
      return require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Event.filter(this._onDidChangeValue.event, e => e.scope === scope && (key === void 0 || e.key === key), disposable);
    }
    emitDidChangeValue(scope, event) {
      const {key, external} = event;
      if (key === "__$__targetStorageMarker") {
        switch(scope) {
          case -1:
            this._applicationKeyTargets = void 0;
            break;
          case 0:
            this._profileKeyTargets = void 0;
            break;
          case 1:
            this._workspaceKeyTargets = void 0;
        }
        this._onDidChangeTarget.fire({scope});
      } else {
        this._onDidChangeValue.fire({scope, key, target:this.getKeyTargets(scope)[key], external});
      }
    }
    get(key, scope, fallbackValue) {
      var _a;
      return (_a = this.getStorage(scope)) === null || _a === void 0 ? void 0 : _a.get(key, fallbackValue);
    }
    getBoolean(key, scope, fallbackValue) {
      var _a;
      return (_a = this.getStorage(scope)) === null || _a === void 0 ? void 0 : _a.getBoolean(key, fallbackValue);
    }
    getNumber(key, scope, fallbackValue) {
      var _a;
      return (_a = this.getStorage(scope)) === null || _a === void 0 ? void 0 : _a.getNumber(key, fallbackValue);
    }
    store(key, value, scope, target, external = !1) {
      (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_types_DOT_js.isUndefinedOrNull)(value) ? this.remove(key, scope, external) : this.withPausedEmitters(() => {
        var _a;
        this.updateKeyTarget(key, scope, target);
        (_a = this.getStorage(scope)) === null || _a === void 0 || _a.set(key, value, external);
      });
    }
    remove(key, scope, external = !1) {
      this.withPausedEmitters(() => {
        var _a;
        this.updateKeyTarget(key, scope, void 0);
        (_a = this.getStorage(scope)) === null || _a === void 0 || _a.delete(key, external);
      });
    }
    withPausedEmitters(fn) {
      this._onDidChangeValue.pause();
      this._onDidChangeTarget.pause();
      try {
        fn();
      } finally {
        this._onDidChangeValue.resume(), this._onDidChangeTarget.resume();
      }
    }
    updateKeyTarget(key, scope, target, external = !1) {
      var _a, _b;
      const keyTargets = this.getKeyTargets(scope);
      typeof target === "number" ? keyTargets[key] !== target && (keyTargets[key] = target, (_a = this.getStorage(scope)) === null || _a === void 0 || _a.set("__$__targetStorageMarker", JSON.stringify(keyTargets), external)) : typeof keyTargets[key] === "number" && (delete keyTargets[key], (_b = this.getStorage(scope)) === null || _b === void 0 || _b.set("__$__targetStorageMarker", JSON.stringify(keyTargets), external));
    }
    get workspaceKeyTargets() {
      this._workspaceKeyTargets || (this._workspaceKeyTargets = this.loadKeyTargets(1));
      return this._workspaceKeyTargets;
    }
    get profileKeyTargets() {
      this._profileKeyTargets || (this._profileKeyTargets = this.loadKeyTargets(0));
      return this._profileKeyTargets;
    }
    get applicationKeyTargets() {
      this._applicationKeyTargets || (this._applicationKeyTargets = this.loadKeyTargets(-1));
      return this._applicationKeyTargets;
    }
    getKeyTargets(scope) {
      switch(scope) {
        case -1:
          return this.applicationKeyTargets;
        case 0:
          return this.profileKeyTargets;
        default:
          return this.workspaceKeyTargets;
      }
    }
    loadKeyTargets(scope) {
      return (scope = this.getStorage(scope)) ? loadKeyTargets(scope) : Object.create(null);
    }
  }
  AbstractStorageService.DEFAULT_FLUSH_INTERVAL = 6E4;
  class InMemoryStorageService extends AbstractStorageService {
    constructor() {
      super();
      this.applicationStorage = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.Storage(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.InMemoryStorageDatabase(), {hint:require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.StorageHint.STORAGE_IN_MEMORY}));
      this.profileStorage = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.Storage(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.InMemoryStorageDatabase(), {hint:require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.StorageHint.STORAGE_IN_MEMORY}));
      this.workspaceStorage = this._register(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.Storage(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.InMemoryStorageDatabase(), {hint:require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_parts_SLASH_storage_SLASH_common_SLASH_storage_DOT_js.StorageHint.STORAGE_IN_MEMORY}));
      this._register(this.workspaceStorage.onDidChangeStorage(e => this.emitDidChangeValue(1, e)));
      this._register(this.profileStorage.onDidChangeStorage(e => this.emitDidChangeValue(0, e)));
      this._register(this.applicationStorage.onDidChangeStorage(e => this.emitDidChangeValue(-1, e)));
    }
    getStorage(scope) {
      switch(scope) {
        case -1:
          return this.applicationStorage;
        case 0:
          return this.profileStorage;
        default:
          return this.workspaceStorage;
      }
    }
  }
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$platform$storage$common$storage.js.map
