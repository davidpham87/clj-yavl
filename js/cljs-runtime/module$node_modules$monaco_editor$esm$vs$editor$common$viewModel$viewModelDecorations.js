shadow$provide.module$node_modules$monaco_editor$esm$vs$editor$common$viewModel$viewModelDecorations = function(require, module, exports) {
  function isModelDecorationVisible(model, decoration) {
    return decoration.options.hideInCommentTokens && isModelDecorationInComment(model, decoration) || decoration.options.hideInStringTokens && isModelDecorationInString(model, decoration) ? !1 : !0;
  }
  function isModelDecorationInComment(model, decoration) {
    return testTokensInRange(model, decoration.range, tokenType => tokenType === 1);
  }
  function isModelDecorationInString(model, decoration) {
    return testTokensInRange(model, decoration.range, tokenType => tokenType === 2);
  }
  function testTokensInRange(model, range, callback) {
    for (let lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {
      const lineTokens = model.tokenization.getLineTokens(lineNumber), isEndLine = lineNumber === range.endLineNumber;
      let tokenIdx = lineNumber === range.startLineNumber ? lineTokens.findTokenIndexAtOffset(range.startColumn - 1) : 0;
      for (; tokenIdx < lineTokens.getCount() && !(isEndLine && lineTokens.getStartOffset(tokenIdx) > range.endColumn - 1);) {
        if (!callback(lineTokens.getStandardTokenType(tokenIdx))) {
          return !1;
        }
        tokenIdx++;
      }
    }
    return !0;
  }
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, ViewModelDecorations:{enumerable:!0, get:function() {
    return ViewModelDecorations;
  }}, isModelDecorationInComment:{enumerable:!0, get:function() {
    return isModelDecorationInComment;
  }}, isModelDecorationInString:{enumerable:!0, get:function() {
    return isModelDecorationInString;
  }}, isModelDecorationVisible:{enumerable:!0, get:function() {
    return isModelDecorationVisible;
  }}});
  var require$_DOT__DOT__SLASH_core_SLASH_position_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$core$position"), require$_DOT__DOT__SLASH_core_SLASH_range_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$core$range"), require$_DOT__DOT__SLASH_viewModel_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$viewModel"), require$_DOT__DOT__SLASH_config_SLASH_editorOptions_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$config$editorOptions");
  class ViewModelDecorations {
    constructor(editorId, model, configuration, linesCollection, coordinatesConverter) {
      this.editorId = editorId;
      this.model = model;
      this.configuration = configuration;
      this._linesCollection = linesCollection;
      this._coordinatesConverter = coordinatesConverter;
      this._decorationsCache = Object.create(null);
      this._cachedModelDecorationsResolverViewRange = this._cachedModelDecorationsResolver = null;
    }
    _clearCachedModelDecorationsResolver() {
      this._cachedModelDecorationsResolverViewRange = this._cachedModelDecorationsResolver = null;
    }
    dispose() {
      this._decorationsCache = Object.create(null);
      this._clearCachedModelDecorationsResolver();
    }
    reset() {
      this._decorationsCache = Object.create(null);
      this._clearCachedModelDecorationsResolver();
    }
    onModelDecorationsChanged() {
      this._decorationsCache = Object.create(null);
      this._clearCachedModelDecorationsResolver();
    }
    onLineMappingChanged() {
      this._decorationsCache = Object.create(null);
      this._clearCachedModelDecorationsResolver();
    }
    _getOrCreateViewModelDecoration(modelDecoration) {
      const id = modelDecoration.id;
      var r = this._decorationsCache[id];
      if (!r) {
        r = modelDecoration.range;
        modelDecoration = modelDecoration.options;
        if (modelDecoration.isWholeLine) {
          const start = this._coordinatesConverter.convertModelPositionToViewPosition(new require$_DOT__DOT__SLASH_core_SLASH_position_DOT_js.Position(r.startLineNumber, 1), 0, !1, !0);
          r = this._coordinatesConverter.convertModelPositionToViewPosition(new require$_DOT__DOT__SLASH_core_SLASH_position_DOT_js.Position(r.endLineNumber, this.model.getLineMaxColumn(r.endLineNumber)), 1);
          r = new require$_DOT__DOT__SLASH_core_SLASH_range_DOT_js.Range(start.lineNumber, start.column, r.lineNumber, r.column);
        } else {
          r = this._coordinatesConverter.convertModelRangeToViewRange(r, 1);
        }
        r = new require$_DOT__DOT__SLASH_viewModel_DOT_js.ViewModelDecoration(r, modelDecoration);
        this._decorationsCache[id] = r;
      }
      return r;
    }
    getMinimapDecorationsInRange(range) {
      return this._getDecorationsInRange(range, !0, !1).decorations;
    }
    getDecorationsViewportData(viewRange) {
      let cacheIsValid = this._cachedModelDecorationsResolver !== null;
      cacheIsValid = cacheIsValid && viewRange.equalsRange(this._cachedModelDecorationsResolverViewRange);
      cacheIsValid || (this._cachedModelDecorationsResolver = this._getDecorationsInRange(viewRange, !1, !1), this._cachedModelDecorationsResolverViewRange = viewRange);
      return this._cachedModelDecorationsResolver;
    }
    getInlineDecorationsOnLine(lineNumber, onlyMinimapDecorations = !1, onlyMarginDecorations = !1) {
      lineNumber = new require$_DOT__DOT__SLASH_core_SLASH_range_DOT_js.Range(lineNumber, this._linesCollection.getViewLineMinColumn(lineNumber), lineNumber, this._linesCollection.getViewLineMaxColumn(lineNumber));
      return this._getDecorationsInRange(lineNumber, onlyMinimapDecorations, onlyMarginDecorations).inlineDecorations[0];
    }
    _getDecorationsInRange(viewRange, onlyMinimapDecorations, onlyMarginDecorations) {
      onlyMinimapDecorations = this._linesCollection.getDecorationsInRange(viewRange, this.editorId, (0,require$_DOT__DOT__SLASH_config_SLASH_editorOptions_DOT_js.filterValidationDecorations)(this.configuration.options), onlyMinimapDecorations, onlyMarginDecorations);
      onlyMarginDecorations = viewRange.startLineNumber;
      viewRange = viewRange.endLineNumber;
      const decorationsInViewport = [];
      let decorationsInViewportLen = 0;
      const inlineDecorations = [];
      for (var j = onlyMarginDecorations; j <= viewRange; j++) {
        inlineDecorations[j - onlyMarginDecorations] = [];
      }
      for (let i = 0, len = onlyMinimapDecorations.length; i < len; i++) {
        var modelDecoration = onlyMinimapDecorations[i];
        j = modelDecoration.options;
        if (isModelDecorationVisible(this.model, modelDecoration)) {
          var viewModelDecoration = this._getOrCreateViewModelDecoration(modelDecoration);
          modelDecoration = viewModelDecoration.range;
          decorationsInViewport[decorationsInViewportLen++] = viewModelDecoration;
          if (j.inlineClassName) {
            viewModelDecoration = new require$_DOT__DOT__SLASH_viewModel_DOT_js.InlineDecoration(modelDecoration, j.inlineClassName, j.inlineClassNameAffectsLetterSpacing ? 3 : 0);
            var intersectedStartLineNumber = Math.max(onlyMarginDecorations, modelDecoration.startLineNumber);
            const intersectedEndLineNumber = Math.min(viewRange, modelDecoration.endLineNumber);
            for (; intersectedStartLineNumber <= intersectedEndLineNumber; intersectedStartLineNumber++) {
              inlineDecorations[intersectedStartLineNumber - onlyMarginDecorations].push(viewModelDecoration);
            }
          }
          j.beforeContentClassName && onlyMarginDecorations <= modelDecoration.startLineNumber && modelDecoration.startLineNumber <= viewRange && (viewModelDecoration = new require$_DOT__DOT__SLASH_viewModel_DOT_js.InlineDecoration(new require$_DOT__DOT__SLASH_core_SLASH_range_DOT_js.Range(modelDecoration.startLineNumber, modelDecoration.startColumn, modelDecoration.startLineNumber, modelDecoration.startColumn), j.beforeContentClassName, 1), inlineDecorations[modelDecoration.startLineNumber - onlyMarginDecorations].push(viewModelDecoration));
          j.afterContentClassName && onlyMarginDecorations <= modelDecoration.endLineNumber && modelDecoration.endLineNumber <= viewRange && (j = new require$_DOT__DOT__SLASH_viewModel_DOT_js.InlineDecoration(new require$_DOT__DOT__SLASH_core_SLASH_range_DOT_js.Range(modelDecoration.endLineNumber, modelDecoration.endColumn, modelDecoration.endLineNumber, modelDecoration.endColumn), j.afterContentClassName, 2), inlineDecorations[modelDecoration.endLineNumber - onlyMarginDecorations].push(j));
        }
      }
      return {decorations:decorationsInViewport, inlineDecorations};
    }
  }
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$editor$common$viewModel$viewModelDecorations.js.map
