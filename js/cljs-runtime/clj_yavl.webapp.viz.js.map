{"version":3,"sources":["clj_yavl/webapp/viz.cljs"],"mappings":";;AAIA,oCAAA,pCAAMA,gFAAeC;AAArB,AACE,IAAMC,gBAAc,gDAAA,hDAACC;IACfC,WAAS,gDAAA,hDAACD;AADhB,AAEE,+DAAA,2CAAA,oEAAA,gBAAA,vLAACE,2QAGC,WAAKC;AAAL,AACE,oBAAM,iBAAAC,oBAAA,AAAAC,gBAAMN;AAAN,AAAA,oBAAAK;AAAoBN;;AAApBM;;;AAAN,+EACOL,xEACD,wDAAA,AAAAM,xDAACC,uFAAU,AAACC,qBAAQT,MAAM,qBAAA,2CAAA,2DAAA,3HAACS,lHAC3B,iQAAO,WAAKC,nRAEZ;AAFO,AACE,OAACC,sBAAOR,SAAS,AAAQO;UAC1B,WAAKE;AAAL,AACE,qBAAA,dAACC,0CAA6CD;;;AAN9D;;GAJJ,sFAYE,WAAKE;AAAL,AACE,IAAMC,WAAS,AAACC,iBAAO,AAACC,kBAAOH;AAA/B,AACE,oBAAM,iBAAAR,oBAAA,AAAAC,gBAAMN;AAAN,AAAA,oBAAAK;AAAoBS;;AAApBT;;;AAAN,+EACOL,xEACD,wDAAA,AAAAM,xDAACC,uFAAU,AAACC,qBAAQM,UAAU,qBAAA,2CAAA,2DAAA,3HAACN,tHAC/B,qQAAO,WAAKC,vRAEZ;AAFO,AACE,OAACC,sBAAOR,SAAS,AAAQO;UAC1B,WAAKE;AAAL,AACE,qBAAA,dAACC,2CAA8CD;;;AAN/D;;GAdN,0FAsBE,WAAKP;AAAL,AACE,oBAAA,AAAAE,gBAAOJ;AAAP,AACE,OAAA,AAAAI,gBAAYJ;;AADd;;GAvBJ,yEA0BE,WAAKH;AAAL,AAAA,0FAAA,mDAAA,2CAAA,wDAAA,kCAAA,mDAAA,WAAAkB;AAAA,AAEe,2CAAAA,pCAACP,sBAAOV","names":["clj-yavl.webapp.viz/vega-lite-viz","spec","container-ref","reagent.core.atom","view-ref","reagent.core.create_class","_","and__5023__auto__","cljs.core/deref","js/module$node_modules$vega_embed$build$vega_embed.default","cljs.core/clj->js","res","cljs.core/reset!","err","js/console.error","this","new-spec","cljs.core/second","reagent.core/argv","p1__29675#"],"sourcesContent":["(ns clj-yavl.webapp.viz\n  (:require [reagent.core :as r]\n            [\"vega-embed\" :default vegaEmbed]))\n\n(defn vega-lite-viz [spec]\n  (let [container-ref (r/atom nil)\n        view-ref (r/atom nil)]\n    (r/create-class\n     {:display-name \"vega-lite-viz\"\n      :component-did-mount\n      (fn [_]\n        (when (and @container-ref spec)\n          (-> @container-ref\n              (vegaEmbed (clj->js spec) (clj->js {:actions true}))\n              (.then (fn [res]\n                       (reset! view-ref (.-view res))))\n              (.catch (fn [err]\n                        (js/console.error \"Vega Embed Error (mount):\" err))))))\n      :component-did-update\n      (fn [this]\n        (let [new-spec (second (r/argv this))]\n          (when (and @container-ref new-spec)\n            (-> @container-ref\n                (vegaEmbed (clj->js new-spec) (clj->js {:actions true}))\n                (.then (fn [res]\n                         (reset! view-ref (.-view res))))\n                (.catch (fn [err]\n                          (js/console.error \"Vega Embed Error (update):\" err)))))))\n      :component-will-unmount\n      (fn [_]\n        (when @view-ref\n          (.finalize @view-ref)))\n      :reagent-render\n      (fn [spec]\n        [:div {:class \"w-full h-full overflow-auto p-4\"\n               :ref #(reset! container-ref %)}])})))\n"]}