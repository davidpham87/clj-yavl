shadow$provide.module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorWidget = function(require, module, exports) {
  function toLineChanges(state) {
    return state.mappings.map(x => {
      var m = x.lineRangeMapping;
      let originalEndLineNumber, modifiedStartLineNumber, innerChanges = m.innerChanges;
      m.original.isEmpty ? (x = m.original.startLineNumber - 1, originalEndLineNumber = 0, innerChanges = void 0) : (x = m.original.startLineNumber, originalEndLineNumber = m.original.endLineNumberExclusive - 1);
      m.modified.isEmpty ? (modifiedStartLineNumber = m.modified.startLineNumber - 1, m = 0, innerChanges = void 0) : (modifiedStartLineNumber = m.modified.startLineNumber, m = m.modified.endLineNumberExclusive - 1);
      return {originalStartLineNumber:x, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber:m, charChanges:innerChanges === null || innerChanges === void 0 ? void 0 : innerChanges.map(m => ({originalStartLineNumber:m.originalRange.startLineNumber, originalStartColumn:m.originalRange.startColumn, originalEndLineNumber:m.originalRange.endLineNumber, originalEndColumn:m.originalRange.endColumn, modifiedStartLineNumber:m.modifiedRange.startLineNumber, modifiedStartColumn:m.modifiedRange.startColumn, 
      modifiedEndLineNumber:m.modifiedRange.endLineNumber, modifiedEndColumn:m.modifiedRange.endColumn}))};
    });
  }
  Object.defineProperties(exports, {__esModule:{enumerable:!0, value:!0}, DiffEditorWidget:{enumerable:!0, get:function() {
    return DiffEditorWidget;
  }}});
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$browser$dom"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_arraysFind_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$arraysFind"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_errors_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$base$common$errors"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$event"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$lifecycle"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$base$common$observable"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js = require("module$node_modules$monaco_editor$esm$vs$base$common$observableInternal$derived");
  require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$style_css");
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH_editorExtensions_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$editorExtensions");
  module = require("module$node_modules$monaco_editor$esm$vs$editor$browser$services$codeEditorService");
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH_stableEditorScroll_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$stableEditorScroll"), require$_DOT__DOT__SLASH_codeEditorWidget_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$codeEditorWidget"), require$_DOT__SLASH_accessibleDiffViewer_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$accessibleDiffViewer"), require$_DOT__SLASH_diffEditorDecorations_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorDecorations"), require$_DOT__SLASH_diffEditorSash_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorSash"), require$_DOT__SLASH_hideUnchangedRegionsFeature_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$hideUnchangedRegionsFeature"), require$_DOT__SLASH_lineAlignment_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$lineAlignment"), 
  require$_DOT__SLASH_movedBlocksLines_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$movedBlocksLines"), require$_DOT__SLASH_overviewRulerPart_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$overviewRulerPart"), require$_DOT__SLASH_utils_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$utils"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_position_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$editor$common$core$position"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_range_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$core$range"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorCommon_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$common$editorCommon"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorContextKeys_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$editor$common$editorContextKeys"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$audioCues$browser$audioCueService"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$contextkey$common$contextkey");
  exports = require("module$node_modules$monaco_editor$esm$vs$platform$instantiation$common$instantiation");
  var require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_instantiation_SLASH_common_SLASH_serviceCollection_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$instantiation$common$serviceCollection"), require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_progress_SLASH_common_SLASH_progress_DOT_js = require("module$node_modules$monaco_editor$esm$vs$platform$progress$common$progress");
  require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$colors");
  var require$_DOT__SLASH_delegatingEditorImpl_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$delegatingEditorImpl"), require$_DOT__SLASH_diffEditorEditors_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorEditors"), require$_DOT__SLASH_diffEditorOptions_DOT_js = require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorOptions"), require$_DOT__SLASH_diffEditorViewModel_DOT_js = 
  require("module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorViewModel");
  require = this && this.__param || function(paramIndex, decorator) {
    return function(target, key) {
      decorator(target, key, paramIndex);
    };
  };
  let DiffEditorWidget = class extends require$_DOT__SLASH_delegatingEditorImpl_DOT_js.DelegatingEditor {
    get onDidContentSizeChange() {
      return this._editors.onDidContentSizeChange;
    }
    constructor(_domElement, options, codeEditorWidgetOptions, _parentContextKeyService, _parentInstantiationService, codeEditorService, _audioCueService, _editorProgressService) {
      var _a;
      super();
      this._domElement = _domElement;
      this._parentContextKeyService = _parentContextKeyService;
      this._parentInstantiationService = _parentInstantiationService;
      this._audioCueService = _audioCueService;
      this._editorProgressService = _editorProgressService;
      this.elements = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.h)("div.monaco-diff-editor.side-by-side", {style:{position:"relative", height:"100%"}}, [(0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.h)("div.noModificationsOverlay@overlay", {style:{position:"absolute", height:"100%", visibility:"hidden"}}, [(0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.$)("span", 
      {}, "No Changes")]), (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.h)("div.editor.original@original", {style:{position:"absolute", height:"100%"}}), (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.h)("div.editor.modified@modified", {style:{position:"absolute", height:"100%"}}), (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.h)("div.accessibleDiffViewer@accessibleDiffViewer", 
      {style:{position:"absolute", height:"100%"}})]);
      this._diffModel = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.observableValue)(this, void 0);
      this._shouldDisposeDiffModel = !1;
      this.onDidChangeModel = require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Event.fromObservableLight(this._diffModel);
      this._contextKeyService = this._register(this._parentContextKeyService.createScoped(this._domElement));
      this._instantiationService = this._parentInstantiationService.createChild(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_instantiation_SLASH_common_SLASH_serviceCollection_DOT_js.ServiceCollection([require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js.IContextKeyService, this._contextKeyService]));
      this._boundarySashes = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.observableValue)(this, void 0);
      this._accessibleDiffViewerShouldBeVisible = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.observableValue)(this, !1);
      this._accessibleDiffViewerVisible = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(this, reader => this._options.onlyShowAccessibleDiffViewer.read(reader) ? !0 : this._accessibleDiffViewerShouldBeVisible.read(reader));
      this._movedBlocksLinesPart = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.observableValue)(this, void 0);
      this._layoutInfo = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(this, reader => {
        var _a, _b, _c, _d, _e, width = this._rootSizeObserver.width.read(reader);
        const height = this._rootSizeObserver.height.read(reader), sashLeft = (_a = this._sash.read(reader)) === null || _a === void 0 ? void 0 : _a.sashLeft.read(reader);
        _a = sashLeft !== null && sashLeft !== void 0 ? sashLeft : Math.max(5, this._editors.original.getLayoutInfo().decorationsLeft);
        width = width - _a - ((_c = (_b = this._overviewRulerPart.read(reader)) === null || _b === void 0 ? void 0 : _b.width) !== null && _c !== void 0 ? _c : 0);
        _b = (_e = (_d = this._movedBlocksLinesPart.read(reader)) === null || _d === void 0 ? void 0 : _d.width.read(reader)) !== null && _e !== void 0 ? _e : 0;
        reader = _a - _b;
        this.elements.original.style.width = reader + "px";
        this.elements.original.style.left = "0px";
        this.elements.modified.style.width = width + "px";
        this.elements.modified.style.left = _a + "px";
        this._editors.original.layout({width:reader, height}, !0);
        this._editors.modified.layout({width, height}, !0);
        return {modifiedEditor:this._editors.modified.getLayoutInfo(), originalEditor:this._editors.original.getLayoutInfo()};
      });
      this._diffValue = this._diffModel.map((m, r) => m === null || m === void 0 ? void 0 : m.diff.read(r));
      this.onDidUpdateDiff = require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Event.fromObservableLight(this._diffValue);
      codeEditorService.willCreateDiffEditor();
      this._contextKeyService.createKey("isInDiffEditor", !0);
      this._domElement.appendChild(this.elements.root);
      this._register((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => this._domElement.removeChild(this.elements.root)));
      this._rootSizeObserver = this._register(new require$_DOT__SLASH_utils_DOT_js.ObservableElementSizeObserver(this.elements.root, options.dimension));
      this._rootSizeObserver.setAutomaticLayout((_a = options.automaticLayout) !== null && _a !== void 0 ? _a : !1);
      this._options = new require$_DOT__SLASH_diffEditorOptions_DOT_js.DiffEditorOptions(options);
      this._register((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.autorun)(reader => {
        this._options.setWidth(this._rootSizeObserver.width.read(reader));
      }));
      this._contextKeyService.createKey(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorContextKeys_DOT_js.EditorContextKeys.isEmbeddedDiffEditor.key, !1);
      this._register((0,require$_DOT__SLASH_utils_DOT_js.bindContextKey)(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorContextKeys_DOT_js.EditorContextKeys.isEmbeddedDiffEditor, this._contextKeyService, reader => this._options.isInEmbeddedEditor.read(reader)));
      this._register((0,require$_DOT__SLASH_utils_DOT_js.bindContextKey)(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorContextKeys_DOT_js.EditorContextKeys.comparingMovedCode, this._contextKeyService, reader => {
        var _a;
        return !((_a = this._diffModel.read(reader)) === null || _a === void 0 || !_a.movedTextToCompare.read(reader));
      }));
      this._register((0,require$_DOT__SLASH_utils_DOT_js.bindContextKey)(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorContextKeys_DOT_js.EditorContextKeys.diffEditorRenderSideBySideInlineBreakpointReached, this._contextKeyService, reader => this._options.couldShowInlineViewBecauseOfSize.read(reader)));
      this._register((0,require$_DOT__SLASH_utils_DOT_js.bindContextKey)(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorContextKeys_DOT_js.EditorContextKeys.hasChanges, this._contextKeyService, reader => {
        var _a, _b, _c;
        return ((_c = (_b = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader)) === null || _b === void 0 ? void 0 : _b.mappings.length) !== null && _c !== void 0 ? _c : 0) > 0;
      }));
      this._editors = this._register(this._instantiationService.createInstance(require$_DOT__SLASH_diffEditorEditors_DOT_js.DiffEditorEditors, this.elements.original, this.elements.modified, this._options, codeEditorWidgetOptions, (i, c, o, o2) => this._createInnerEditor(i, c, o, o2)));
      this._overviewRulerPart = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => this._options.renderOverviewRuler.read(reader) ? this._instantiationService.createInstance((0,require$_DOT__SLASH_utils_DOT_js.readHotReloadableExport)(require$_DOT__SLASH_overviewRulerPart_DOT_js.OverviewRulerPart, reader), this._editors, this.elements.root, this._diffModel, this._rootSizeObserver.width, 
      this._rootSizeObserver.height, this._layoutInfo.map(i => i.modifiedEditor)) : void 0).recomputeInitiallyAndOnChange(this._store);
      this._sash = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => {
        reader = this._options.renderSideBySide.read(reader);
        this.elements.root.classList.toggle("side-by-side", reader);
        return reader ? new require$_DOT__SLASH_diffEditorSash_DOT_js.DiffEditorSash(this._options, this.elements.root, {height:this._rootSizeObserver.height, width:this._rootSizeObserver.width.map((w, reader) => {
          var _a, _b;
          return w - ((_b = (_a = this._overviewRulerPart.read(reader)) === null || _a === void 0 ? void 0 : _a.width) !== null && _b !== void 0 ? _b : 0);
        })}, this._boundarySashes) : void 0;
      }).recomputeInitiallyAndOnChange(this._store);
      const unchangedRangesFeature = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => this._instantiationService.createInstance((0,require$_DOT__SLASH_utils_DOT_js.readHotReloadableExport)(require$_DOT__SLASH_hideUnchangedRegionsFeature_DOT_js.HideUnchangedRegionsFeature, reader), this._editors, this._diffModel, this._options)).recomputeInitiallyAndOnChange(this._store);
      (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => this._instantiationService.createInstance((0,require$_DOT__SLASH_utils_DOT_js.readHotReloadableExport)(require$_DOT__SLASH_diffEditorDecorations_DOT_js.DiffEditorDecorations, reader), this._editors, this._diffModel, this._options, this)).recomputeInitiallyAndOnChange(this._store);
      const origViewZoneIdsToIgnore = new Set(), modViewZoneIdsToIgnore = new Set();
      let isUpdatingViewZones = !1;
      const viewZoneManager = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => this._instantiationService.createInstance((0,require$_DOT__SLASH_utils_DOT_js.readHotReloadableExport)(require$_DOT__SLASH_lineAlignment_DOT_js.ViewZoneManager, reader), (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_browser_SLASH_dom_DOT_js.getWindow)(this._domElement), 
      this._editors, this._diffModel, this._options, this, () => isUpdatingViewZones || unchangedRangesFeature.get().isUpdatingHiddenAreas, origViewZoneIdsToIgnore, modViewZoneIdsToIgnore)).recomputeInitiallyAndOnChange(this._store);
      _domElement = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(this, reader => {
        const orig = viewZoneManager.read(reader).viewZones.read(reader).orig;
        reader = unchangedRangesFeature.read(reader).viewZones.read(reader).origViewZones;
        return orig.concat(reader);
      });
      options = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(this, reader => {
        const mod = viewZoneManager.read(reader).viewZones.read(reader).mod;
        reader = unchangedRangesFeature.read(reader).viewZones.read(reader).modViewZones;
        return mod.concat(reader);
      });
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyViewZones)(this._editors.original, _domElement, isUpdatingOrigViewZones => {
        isUpdatingViewZones = isUpdatingOrigViewZones;
      }, origViewZoneIdsToIgnore));
      let scrollState;
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyViewZones)(this._editors.modified, options, isUpdatingModViewZones => {
        (isUpdatingViewZones = isUpdatingModViewZones) ? scrollState = require$_DOT__DOT__SLASH__DOT__DOT__SLASH_stableEditorScroll_DOT_js.StableEditorScrollState.capture(this._editors.modified) : (scrollState === null || scrollState === void 0 || scrollState.restore(this._editors.modified), scrollState = void 0);
      }, modViewZoneIdsToIgnore));
      this._accessibleDiffViewer = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => this._instantiationService.createInstance((0,require$_DOT__SLASH_utils_DOT_js.readHotReloadableExport)(require$_DOT__SLASH_accessibleDiffViewer_DOT_js.AccessibleDiffViewer, reader), this.elements.accessibleDiffViewer, this._accessibleDiffViewerVisible, (visible, tx) => this._accessibleDiffViewerShouldBeVisible.set(visible, 
      tx), this._options.onlyShowAccessibleDiffViewer.map(v => !v), this._rootSizeObserver.width, this._rootSizeObserver.height, this._diffModel.map((m, r) => {
        var _a;
        return (_a = m === null || m === void 0 ? void 0 : m.diff.read(r)) === null || _a === void 0 ? void 0 : _a.mappings.map(m => m.lineRangeMapping);
      }), this._editors)).recomputeInitiallyAndOnChange(this._store);
      _domElement = this._accessibleDiffViewerVisible.map(v => v ? "hidden" : "visible");
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyStyle)(this.elements.modified, {visibility:_domElement}));
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyStyle)(this.elements.original, {visibility:_domElement}));
      this._createDiffEditorContributions();
      codeEditorService.addDiffEditor(this);
      this._register((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.recomputeInitiallyAndOnChange)(this._layoutInfo));
      (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observableInternal_SLASH_derived_DOT_js.derivedDisposable)(this, reader => new ((0,require$_DOT__SLASH_utils_DOT_js.readHotReloadableExport)(require$_DOT__SLASH_movedBlocksLines_DOT_js.MovedBlocksLinesPart, reader))(this.elements.root, this._diffModel, this._layoutInfo.map(i => i.originalEditor), this._layoutInfo.map(i => i.modifiedEditor), this._editors)).recomputeInitiallyAndOnChange(this._store, 
      value => {
        this._movedBlocksLinesPart.set(value, void 0);
      });
      this._register((0,require$_DOT__SLASH_utils_DOT_js.applyStyle)(this.elements.overlay, {width:this._layoutInfo.map((i, r) => i.originalEditor.width + (this._options.renderSideBySide.read(r) ? 0 : i.modifiedEditor.width)), visibility:(0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.derived)(reader => {
        var _a, _b;
        return this._options.hideUnchangedRegions.read(reader) && ((_b = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader)) === null || _b === void 0 ? void 0 : _b.mappings.length) === 0 ? "visible" : "hidden";
      })}));
      this._register(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_event_DOT_js.Event.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition, e => {
        var _a, _b;
        if ((e === null || e === void 0 ? void 0 : e.reason) === 3) {
          const diff = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings.find(m => m.lineRangeMapping.modified.contains(e.position.lineNumber));
          (diff === null || diff === void 0 ? 0 : diff.lineRangeMapping.modified.isEmpty) ? this._audioCueService.playAudioCue(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.AudioCue.diffLineDeleted, {source:"diffEditor.cursorPositionChanged"}) : (diff === null || diff === void 0 ? 0 : diff.lineRangeMapping.original.isEmpty) ? this._audioCueService.playAudioCue(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.AudioCue.diffLineInserted, 
          {source:"diffEditor.cursorPositionChanged"}) : diff && this._audioCueService.playAudioCue(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.AudioCue.diffLineModified, {source:"diffEditor.cursorPositionChanged"});
        }
      }));
      const isInitializingDiff = this._diffModel.map(this, (m, reader) => {
        if (m) {
          return m.diff.read(reader) === void 0 && !m.isDiffUpToDate.read(reader);
        }
      });
      this._register((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.autorunWithStore)((reader, store) => {
        if (isInitializingDiff.read(reader) === !0) {
          const r = this._editorProgressService.show(!0, 1000);
          store.add((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => r.done()));
        }
      }));
      this._register((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_lifecycle_DOT_js.toDisposable)(() => {
        var _a;
        this._shouldDisposeDiffModel && ((_a = this._diffModel.get()) === null || _a === void 0 || _a.dispose());
      }));
    }
    _createInnerEditor(instantiationService, container, options, editorWidgetOptions) {
      return instantiationService.createInstance(require$_DOT__DOT__SLASH_codeEditorWidget_DOT_js.CodeEditorWidget, container, options, editorWidgetOptions);
    }
    _createDiffEditorContributions() {
      const contributions = require$_DOT__DOT__SLASH__DOT__DOT__SLASH_editorExtensions_DOT_js.EditorExtensionsRegistry.getDiffEditorContributions();
      for (const desc of contributions) {
        try {
          this._register(this._instantiationService.createInstance(desc.ctor, this));
        } catch (err) {
          (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_errors_DOT_js.onUnexpectedError)(err);
        }
      }
    }
    get _targetEditor() {
      return this._editors.modified;
    }
    getEditorType() {
      return require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_editorCommon_DOT_js.EditorType.IDiffEditor;
    }
    layout(dimension) {
      this._rootSizeObserver.observe(dimension);
    }
    hasTextFocus() {
      return this._editors.original.hasTextFocus() || this._editors.modified.hasTextFocus();
    }
    saveViewState() {
      var _a;
      const originalViewState = this._editors.original.saveViewState(), modifiedViewState = this._editors.modified.saveViewState();
      return {original:originalViewState, modified:modifiedViewState, modelState:(_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.serializeState()};
    }
    restoreViewState(s) {
      var _a;
      s && s.original && s.modified && (this._editors.original.restoreViewState(s.original), this._editors.modified.restoreViewState(s.modified), s.modelState && ((_a = this._diffModel.get()) === null || _a === void 0 || _a.restoreSerializedState(s.modelState)));
    }
    handleInitialized() {
      this._editors.original.handleInitialized();
      this._editors.modified.handleInitialized();
    }
    createViewModel(model) {
      return this._instantiationService.createInstance(require$_DOT__SLASH_diffEditorViewModel_DOT_js.DiffEditorViewModel, model, this._options);
    }
    getModel() {
      var _a, _b;
      return (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.model) !== null && _b !== void 0 ? _b : null;
    }
    setModel(model, tx) {
      !model && this._diffModel.get() && this._accessibleDiffViewer.get().close();
      const vm = model ? "model" in model ? {model, shouldDispose:!1} : {model:this.createViewModel(model), shouldDispose:!0} : void 0;
      this._diffModel.get() !== (vm === null || vm === void 0 ? void 0 : vm.model) && (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.subtransaction)(tx, tx => {
        var _a;
        require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.observableFromEvent.batchEventsGlobally(tx, () => {
          this._editors.original.setModel(vm ? vm.model.model.original : null);
          this._editors.modified.setModel(vm ? vm.model.model.modified : null);
        });
        const prevValue = this._diffModel.get(), shouldDispose = this._shouldDisposeDiffModel;
        this._shouldDisposeDiffModel = (_a = vm === null || vm === void 0 ? void 0 : vm.shouldDispose) !== null && _a !== void 0 ? _a : !1;
        this._diffModel.set(vm === null || vm === void 0 ? void 0 : vm.model, tx);
        shouldDispose && (prevValue === null || prevValue === void 0 || prevValue.dispose());
      });
    }
    updateOptions(changedOptions) {
      this._options.updateOptions(changedOptions);
    }
    getContainerDomNode() {
      return this._domElement;
    }
    getOriginalEditor() {
      return this._editors.original;
    }
    getModifiedEditor() {
      return this._editors.modified;
    }
    getLineChanges() {
      var _a;
      const diffState = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get();
      return diffState ? toLineChanges(diffState) : null;
    }
    revert(diff) {
      var _a;
      if (diff.innerChanges) {
        this.revertRangeMappings(diff.innerChanges);
      } else {
        var model = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.model;
        model && this._editors.modified.executeEdits("diffEditor", [{range:diff.modified.toExclusiveRange(), text:model.original.getValueInRange(diff.original.toExclusiveRange())}]);
      }
    }
    revertRangeMappings(diffs) {
      const model = this._diffModel.get();
      model && model.isDiffUpToDate.get() && (diffs = diffs.map(c => ({range:c.modifiedRange, text:model.model.original.getValueInRange(c.originalRange)})), this._editors.modified.executeEdits("diffEditor", diffs));
    }
    _goTo(diff) {
      this._editors.modified.setPosition(new require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_position_DOT_js.Position(diff.lineRangeMapping.modified.startLineNumber, 1));
      this._editors.modified.revealRangeInCenter(diff.lineRangeMapping.modified.toExclusiveRange());
    }
    goToDiff(target) {
      var _a, _b, _c, _d;
      const diffs = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings;
      if (diffs && diffs.length !== 0) {
        var curLineNumber = this._editors.modified.getPosition().lineNumber;
        target = target === "next" ? (_c = diffs.find(d => d.lineRangeMapping.modified.startLineNumber > curLineNumber)) !== null && _c !== void 0 ? _c : diffs[0] : (_d = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_arraysFind_DOT_js.findLast)(diffs, d => d.lineRangeMapping.modified.startLineNumber < curLineNumber)) !== null && _d !== void 0 ? _d : diffs[diffs.length - 1];
        this._goTo(target);
        target.lineRangeMapping.modified.isEmpty ? this._audioCueService.playAudioCue(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.AudioCue.diffLineDeleted, {source:"diffEditor.goToDiff"}) : target.lineRangeMapping.original.isEmpty ? this._audioCueService.playAudioCue(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.AudioCue.diffLineInserted, 
        {source:"diffEditor.goToDiff"}) : target && this._audioCueService.playAudioCue(require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.AudioCue.diffLineModified, {source:"diffEditor.goToDiff"});
      }
    }
    revealFirstDiff() {
      const diffModel = this._diffModel.get();
      diffModel && this.waitForDiff().then(() => {
        var _a;
        const diffs = (_a = diffModel.diff.get()) === null || _a === void 0 ? void 0 : _a.mappings;
        diffs && diffs.length !== 0 && this._goTo(diffs[0]);
      });
    }
    accessibleDiffViewerNext() {
      this._accessibleDiffViewer.get().next();
    }
    accessibleDiffViewerPrev() {
      this._accessibleDiffViewer.get().prev();
    }
    async waitForDiff() {
      const diffModel = this._diffModel.get();
      diffModel && await diffModel.waitForDiff();
    }
    mapToOtherSide() {
      var _a, _b;
      const isModifiedFocus = this._editors.modified.hasWidgetFocus(), destination = isModifiedFocus ? this._editors.original : this._editors.modified;
      let destinationSelection;
      var sourceSelection = (isModifiedFocus ? this._editors.modified : this._editors.original).getSelection();
      if (sourceSelection) {
        const mappings = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings.map(m => isModifiedFocus ? m.lineRangeMapping.flip() : m.lineRangeMapping);
        mappings && (_a = (0,require$_DOT__SLASH_utils_DOT_js.translatePosition)(sourceSelection.getStartPosition(), mappings), sourceSelection = (0,require$_DOT__SLASH_utils_DOT_js.translatePosition)(sourceSelection.getEndPosition(), mappings), destinationSelection = require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_common_SLASH_core_SLASH_range_DOT_js.Range.plusRange(_a, sourceSelection));
      }
      return {destination, destinationSelection};
    }
    switchSide() {
      const {destination, destinationSelection} = this.mapToOtherSide();
      destination.focus();
      destinationSelection && destination.setSelection(destinationSelection);
    }
    exitCompareMove() {
      const model = this._diffModel.get();
      model && model.movedTextToCompare.set(void 0, void 0);
    }
    collapseAllUnchangedRegions() {
      var _a;
      const unchangedRegions = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.unchangedRegions.get();
      unchangedRegions && (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.transaction)(tx => {
        for (const region of unchangedRegions) {
          region.collapseAll(tx);
        }
      });
    }
    showAllUnchangedRegions() {
      var _a;
      const unchangedRegions = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.unchangedRegions.get();
      unchangedRegions && (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_base_SLASH_common_SLASH_observable_DOT_js.transaction)(tx => {
        for (const region of unchangedRegions) {
          region.showAll(tx);
        }
      });
    }
  };
  DiffEditorWidget = (this && this.__decorate || function(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") {
      r = Reflect.decorate(decorators, target, key, desc);
    } else {
      for (var i = decorators.length - 1; i >= 0; i--) {
        if (d = decorators[i]) {
          r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        }
      }
    }
    return c > 3 && r && Object.defineProperty(target, key, r), r;
  })([require(3, require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_contextkey_SLASH_common_SLASH_contextkey_DOT_js.IContextKeyService), require(4, exports.IInstantiationService), require(5, module.ICodeEditorService), require(6, require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_audioCues_SLASH_browser_SLASH_audioCueService_DOT_js.IAudioCueService), require(7, require$_DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH__DOT__DOT__SLASH_platform_SLASH_progress_SLASH_common_SLASH_progress_DOT_js.IEditorProgressService)], 
  DiffEditorWidget);
};

//# sourceMappingURL=module$node_modules$monaco_editor$esm$vs$editor$browser$widget$diffEditor$diffEditorWidget.js.map
